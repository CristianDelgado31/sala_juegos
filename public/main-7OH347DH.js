import{$ as Fr,Aa as Ln,C as J,D as he,E as Ne,Ea as Fn,F as ie,Fa as Un,H as Dh,I as N,J as R,K as ce,N as Xt,O as ue,P as Oe,Q as xh,R as Nh,S as Oh,T as Yo,U as V,V as Zt,W as zi,X as Dt,Y as xt,Z as Nt,_ as Ae,a as Th,aa as Vh,b as bh,ba as Mh,c as Rt,ca as Lh,d as y,da as Fh,e as Lr,ea as Uh,f as Ah,fa as qh,g as Sh,ga as Bh,h as Ch,ha as $i,i as Ko,ia as jh,j as Ho,ja as Be,k as Qo,l as Jo,la as zh,m as Ph,ma as $h,n as ji,p as Pn,pa as Gh,q as Rh,qa as Wh,r as qe,ra as Xe,s as be,sa as Dn,ta as Kh,u as Rn,v as Ge,va as xn,w as We,wa as Nn,x as kn,xa as On,y as kt,ya as Vn,z as kh,za as Mn}from"./chunk-WNT6ZDTM.js";var je=class n{userSubject=new Ah(this.isLoggedIn());user$=this.userSubject.asObservable();isLoggedIn(){return!!localStorage.getItem("user")}login(){this.userSubject.next(!0)}logout(){localStorage.removeItem("user"),this.userSubject.next(!1)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ji({token:n,factory:n.\u0275fac,providedIn:"root"})};var ug=()=>["/login"],lg=()=>["/registro"];function hg(n,e){n&1&&(N(0,"button",12),V(1,"Login"),R()),n&2&&ie("routerLink",Fr(1,ug))}function dg(n,e){n&1&&(N(0,"button",13),V(1,"Register"),R()),n&2&&ie("routerLink",Fr(1,lg))}var Gi=class n{constructor(e,t){this.router=e;this.userService=t;this.userService.user$.subscribe(r=>{if(this.userInLocalStorage=r,r){let o=JSON.parse(localStorage.getItem("user")).email.split("@")[0];this.title=`\xA1Bienvenido 
 ${o}!`}})}title="\xA1Bienvenido!";userInLocalStorage=!1;logOut(){this.userService.logout(),console.log("Usuario deslogueado"),this.router.navigate(["/login"])}navigateToGame(e){this.userInLocalStorage?this.router.navigate([e]):this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||n)(he(Xe),he(je))};static \u0275cmp=be({type:n,selectors:[["app-home"]],standalone:!0,features:[Ae],decls:29,vars:3,consts:[[1,"bienvenido-section"],[1,"bienvenido-container"],["class","accion-boton btn_login",3,"routerLink",4,"ngIf"],["class","accion-boton btn_registro",3,"routerLink",4,"ngIf"],[1,"juegos-container"],[1,"juego"],[3,"click"],["src","images/icono_juegos/preguntados.jpg","alt","Juego 1",1,"juego-imagen"],[1,"accion-boton","btn_juegos",3,"click"],["src","images/icono_juegos/ahorcado.png","alt","Juego 2",1,"juego-imagen"],["src","images/icono_juegos/mayor_menor.jpg","alt","Juego 3",1,"juego-imagen"],["src","images/icono_juegos/snake.jpeg","alt","Juego 4",1,"juego-imagen"],[1,"accion-boton","btn_login",3,"routerLink"],[1,"accion-boton","btn_registro",3,"routerLink"]],template:function(t,r){t&1&&(N(0,"section",0)(1,"div",1)(2,"h1"),V(3),R(),Ne(4,hg,2,2,"button",2)(5,dg,2,2,"button",3),N(6,"h2"),V(7,"Lista de juegos"),R(),N(8,"div",4)(9,"div",5)(10,"a",6),ue("click",function(){return r.navigateToGame("/juegos/preguntados")}),ce(11,"img",7),R(),N(12,"button",8),ue("click",function(){return r.navigateToGame("/juegos/preguntados")}),V(13,"Preguntados"),R()(),N(14,"div",5)(15,"a",6),ue("click",function(){return r.navigateToGame("/juegos/ahorcado")}),ce(16,"img",9),R(),N(17,"button",8),ue("click",function(){return r.navigateToGame("/juegos/ahorcado")}),V(18,"Ahorcado"),R()(),N(19,"div",5)(20,"a",6),ue("click",function(){return r.navigateToGame("/juegos/mayor-menor")}),ce(21,"img",10),R(),N(22,"button",8),ue("click",function(){return r.navigateToGame("/juegos/mayor-menor")}),V(23,"Mayor o Menor"),R()(),N(24,"div",5)(25,"a",6),ue("click",function(){return r.navigateToGame("/juegos/snake")}),ce(26,"img",11),R(),N(27,"button",8),ue("click",function(){return r.navigateToGame("/juegos/snake")}),V(28,"Viborita"),R()()()()()),t&2&&(J(3),Zt(r.title),J(),ie("ngIf",!r.userInLocalStorage),J(),ie("ngIf",!r.userInLocalStorage))},dependencies:[Dn,Be],styles:['.bienvenido-section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(to bottom right,#f16a0c,#fb3)}.bienvenido-container[_ngcontent-%COMP%]{background:#000000b3;padding:4rem;border-radius:15px;box-shadow:0 10px 30px #00000080;max-width:800px;width:100%;text-align:center;color:#fff}h1[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-size:2.8rem;font-family:Arial,sans-serif}h2[_ngcontent-%COMP%]{margin:2rem 0 1rem;font-size:2rem}.juegos-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem}.juego[_ngcontent-%COMP%]{text-align:center}.juego-imagen[_ngcontent-%COMP%]{width:150px;height:150px;object-fit:cover;border-radius:10px;margin-bottom:.5rem;transition:transform .3s,box-shadow .3s,filter .3s;box-shadow:0 4px 8px #0000004d;background-color:wheat}.juego-imagen[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 8px 16px #00000080;filter:brightness(1.1)}.accion-boton[_ngcontent-%COMP%]{color:#fff;border:none;padding:.8rem 1.2rem;border-radius:5px;cursor:pointer;font-size:1rem;transition:background-color .3s,transform .2s;width:100%}.btn_login[_ngcontent-%COMP%]{background-color:#007bff}.btn_login[_ngcontent-%COMP%]:hover{background-color:#0056b3}.btn_registro[_ngcontent-%COMP%]{background-color:coral}.btn_registro[_ngcontent-%COMP%]:hover{background-color:tomato}.btn_juegos[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;border:none;padding:.8rem 1.2rem;border-radius:10px;font-size:1.1rem;cursor:pointer;transition:background-color .3s,transform .3s,box-shadow .3s;box-shadow:0 4px 12px #0003;position:relative;overflow:hidden}.btn_juegos[_ngcontent-%COMP%]:after{content:"";position:absolute;top:100%;left:0;height:100%;width:100%;background:#ffffff4d;transition:top .3s}.btn_juegos[_ngcontent-%COMP%]:hover:after{top:0}.btn_juegos[_ngcontent-%COMP%]:hover{background-color:#218838;transform:translateY(-2px);box-shadow:0 8px 16px #0006}.btn_juegos[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 4px 8px #0003}@media (max-width: 768px){.bienvenido-container[_ngcontent-%COMP%]{padding:3rem 1rem}h1[_ngcontent-%COMP%]{font-size:2.5rem}h2[_ngcontent-%COMP%]{font-size:1.8rem}}@media (max-width: 480px){.bienvenido-container[_ngcontent-%COMP%]{padding:2rem .5rem}h1[_ngcontent-%COMP%]{font-size:2rem}h2[_ngcontent-%COMP%]{font-size:1.5rem}}']})};var qn=class{email;password;constructor(e,t){this.email=e,this.password=t}getEmail(){return this.email}getPassword(){return this.password}};var Qh=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},fg=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Jh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,I=(o&3)<<4|u>>4,S=(u&15)<<2|d>>6,P=d&63;h||(P=64,a||(S=64)),r.push(t[p],t[I],t[S],t[P])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Qh(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):fg(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let I=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||I==null)throw new Zo;let S=o<<2|u>>4;if(r.push(S),d!==64){let P=u<<4&240|d>>2;if(r.push(P),I!==64){let O=d<<6&192|I;r.push(O)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Zo=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},pg=function(n){let e=Qh(n);return Jh.encodeByteArray(e,!0)},qr=function(n){return pg(n).replace(/\./g,"")},ta=function(n){try{return Jh.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function mg(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var gg=()=>mg().__FIREBASE_DEFAULTS__,_g=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},yg=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&ta(n[1]);return e&&JSON.parse(e)},Hi=()=>{try{return gg()||_g()||yg()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},na=n=>{var e,t;return(t=(e=Hi())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Yh=n=>{let e=na(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ra=()=>{var n;return(n=Hi())===null||n===void 0?void 0:n.config},ia=n=>{var e;return(e=Hi())===null||e===void 0?void 0:e[`_${n}`]};var Ki=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Xh(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[qr(JSON.stringify(t)),qr(JSON.stringify(a)),""].join(".")}function _e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Zh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_e())}function vg(){var n;let e=(n=Hi())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ed(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function td(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nd(){let n=_e();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function rd(){return!vg()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sa(){try{return typeof indexedDB=="object"}catch{return!1}}function id(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var Ig="FirebaseError",Me=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Ig,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dt.prototype.create)}},dt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?wg(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Me(i,u,r)}};function wg(n,e){return n.replace(Eg,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Eg=/\{\$([^}]+)}/g;function sd(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function tn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(Hh(o)&&Hh(a)){if(!tn(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Hh(n){return n!==null&&typeof n=="object"}function Br(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Bn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function jn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function od(n,e){let t=new ea(n,e);return t.subscribe.bind(t)}var ea=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Tg(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Xo),i.error===void 0&&(i.error=Xo),i.complete===void 0&&(i.complete=Xo);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Tg(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Xo(){}var Mw=4*60*60*1e3;function Se(n){return n&&n._delegate?n._delegate:n}var ze=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var nn="[DEFAULT]";var oa=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ki;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ag(e))try{this.getOrInitializeService({instanceIdentifier:nn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=nn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=nn){return this.instances.has(e)}getOptions(e=nn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bg(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=nn){return this.component?this.component.multipleInstances?e:nn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function bg(n){return n===nn?void 0:n}function Ag(n){return n.instantiationMode==="EAGER"}var Qi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new oa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Sg=[],G=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(G||{}),Cg={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},Pg=G.INFO,Rg={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},kg=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Rg[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ot=class{constructor(e){this.name=e,this._logLevel=Pg,this._logHandler=kg,this._userLogHandler=null,Sg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Cg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}};var Dg=(n,e)=>e.some(t=>n instanceof t),ad,cd;function xg(){return ad||(ad=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ng(){return cd||(cd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var ud=new WeakMap,ca=new WeakMap,ld=new WeakMap,aa=new WeakMap,la=new WeakMap;function Og(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Ze(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&ud.set(t,n)}).catch(()=>{}),la.set(e,n),e}function Vg(n){if(ca.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});ca.set(n,e)}var ua={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ca.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ld.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ze(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function hd(n){ua=n(ua)}function Mg(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ji(this),e,...t);return ld.set(r,e.sort?e.sort():[e]),Ze(r)}:Ng().includes(n)?function(...e){return n.apply(Ji(this),e),Ze(ud.get(this))}:function(...e){return Ze(n.apply(Ji(this),e))}}function Lg(n){return typeof n=="function"?Mg(n):(n instanceof IDBTransaction&&Vg(n),Dg(n,xg())?new Proxy(n,ua):n)}function Ze(n){if(n instanceof IDBRequest)return Og(n);if(aa.has(n))return aa.get(n);let e=Lg(n);return e!==n&&(aa.set(n,e),la.set(e,n)),e}var Ji=n=>la.get(n);function fd(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=Ze(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Ze(a.result),h.oldVersion,h.newVersion,Ze(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Fg=["get","getKey","getAll","getAllKeys","count"],Ug=["put","add","delete","clear"],ha=new Map;function dd(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ha.get(e))return ha.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Ug.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Fg.includes(t)))return;let o=function(a,...u){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return ha.set(e,o),o}hd(n=>bh(Th({},n),{get:(e,t,r)=>dd(e,t)||n.get(e,t,r),has:(e,t)=>!!dd(e,t)||n.has(e,t)}));var fa=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qg(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function qg(n){let e=n.getComponent();return e?.type==="VERSION"}var pa="@firebase/app",pd="0.10.10";var ft=new Ot("@firebase/app"),Bg="@firebase/app-compat",jg="@firebase/analytics-compat",zg="@firebase/analytics",$g="@firebase/app-check-compat",Gg="@firebase/app-check",Wg="@firebase/auth",Kg="@firebase/auth-compat",Hg="@firebase/database",Qg="@firebase/database-compat",Jg="@firebase/functions",Yg="@firebase/functions-compat",Xg="@firebase/installations",Zg="@firebase/installations-compat",e_="@firebase/messaging",t_="@firebase/messaging-compat",n_="@firebase/performance",r_="@firebase/performance-compat",i_="@firebase/remote-config",s_="@firebase/remote-config-compat",o_="@firebase/storage",a_="@firebase/storage-compat",c_="@firebase/firestore",u_="@firebase/vertexai-preview",l_="@firebase/firestore-compat",h_="firebase",d_="10.13.1";var ma="[DEFAULT]",f_={[pa]:"fire-core",[Bg]:"fire-core-compat",[zg]:"fire-analytics",[jg]:"fire-analytics-compat",[Gg]:"fire-app-check",[$g]:"fire-app-check-compat",[Wg]:"fire-auth",[Kg]:"fire-auth-compat",[Hg]:"fire-rtdb",[Qg]:"fire-rtdb-compat",[Jg]:"fire-fn",[Yg]:"fire-fn-compat",[Xg]:"fire-iid",[Zg]:"fire-iid-compat",[e_]:"fire-fcm",[t_]:"fire-fcm-compat",[n_]:"fire-perf",[r_]:"fire-perf-compat",[i_]:"fire-rc",[s_]:"fire-rc-compat",[o_]:"fire-gcs",[a_]:"fire-gcs-compat",[c_]:"fire-fst",[l_]:"fire-fst-compat",[u_]:"fire-vertex","fire-js":"fire-js",[h_]:"fire-js-all"};var jr=new Map,p_=new Map,ga=new Map;function md(n,e){try{n.container.addComponent(e)}catch(t){ft.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Mt(n){let e=n.name;if(ga.has(e))return ft.debug(`There were multiple attempts to register component ${e}.`),!1;ga.set(e,n);for(let t of jr.values())md(t,n);for(let t of p_.values())md(t,n);return!0}function $r(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ke(n){return n.settings!==void 0}var m_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vt=new dt("app","Firebase",m_);var _a=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ze("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vt.create("app-deleted",{appName:this._name})}};var Lt=d_;function Ia(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ma,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Vt.create("bad-app-name",{appName:String(i)});if(t||(t=ra()),!t)throw Vt.create("no-options");let o=jr.get(i);if(o){if(tn(t,o.options)&&tn(r,o.config))return o;throw Vt.create("duplicate-app",{appName:i})}let a=new Qi(i);for(let h of ga.values())a.addComponent(h);let u=new _a(t,r,a);return jr.set(i,u),u}function zn(n=ma){let e=jr.get(n);if(!e&&n===ma&&ra())return Ia();if(!e)throw Vt.create("no-app",{appName:n});return e}function Yi(){return Array.from(jr.values())}function me(n,e,t){var r;let i=(r=f_[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ft.warn(u.join(" "));return}Mt(new ze(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var g_="firebase-heartbeat-database",__=1,zr="firebase-heartbeat-store",da=null;function vd(){return da||(da=fd(g_,__,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Vt.create("idb-open",{originalErrorMessage:n.message})})),da}function y_(n){return y(this,null,function*(){try{let t=(yield vd()).transaction(zr),r=yield t.objectStore(zr).get(Id(n));return yield t.done,r}catch(e){if(e instanceof Me)ft.warn(e.message);else{let t=Vt.create("idb-get",{originalErrorMessage:e?.message});ft.warn(t.message)}}})}function gd(n,e){return y(this,null,function*(){try{let r=(yield vd()).transaction(zr,"readwrite");yield r.objectStore(zr).put(e,Id(n)),yield r.done}catch(t){if(t instanceof Me)ft.warn(t.message);else{let r=Vt.create("idb-set",{originalErrorMessage:t?.message});ft.warn(r.message)}}})}function Id(n){return`${n.name}!${n.options.appId}`}var v_=1024,I_=30*24*60*60*1e3,ya=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new va(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=_d();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=I_}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ft.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=_d(),{heartbeatsToSend:r,unsentEntries:i}=w_(this._heartbeatsCache.heartbeats),o=qr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ft.warn(t),""}})}};function _d(){return new Date().toISOString().substring(0,10)}function w_(n,e=v_){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),yd(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),yd(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var va=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return sa()?id().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield y_(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return gd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return gd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function yd(n){return qr(JSON.stringify({version:2,heartbeats:n})).length}function E_(n){Mt(new ze("platform-logger",e=>new fa(e),"PRIVATE")),Mt(new ze("heartbeat",e=>new ya(e),"PRIVATE")),me(pa,pd,n),me(pa,pd,"esm2017"),me("fire-js","")}E_("");var T_="firebase",b_="10.13.1";me(T_,b_,"app");var sn=new Uh("ANGULARFIRE2_VERSION");function Zi(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Gr=(n,e)=>{let t=e?[e]:Yi(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Gn=class{constructor(){return Gr(A_)}},A_="app-check";function $n(){}var Xi=class{zone;delegate;constructor(e,t=Ch){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},wa=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",$n,{},$n,$n)),t.pipe(Ph({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Wn=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Xi(Zone.current)),this.insideAngular=t.run(()=>new Xi(Zone.current,Sh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Rh(kt))};static \u0275prov=ji({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function es(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function S_(n){return es().ngZone.runOutsideAngular(()=>n())}function rn(n){return es().ngZone.run(()=>n())}function C_(n){return P_(es())(n)}function P_(n){return function(t){return t=t.lift(new wa(n.ngZone)),t.pipe(Qo(n.outsideAngular),Ho(n.insideAngular))}}var R_=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),rn(()=>n.apply(void 0,r))},Le=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=rn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",$n,{},$n,$n))),r[o]=R_(r[o],t));let i=S_(()=>n.apply(this,r));if(!e)if(i instanceof Lr){let o=es();return i.pipe(Qo(o.outsideAngular),Ho(o.insideAngular))}else return rn(()=>i);return i instanceof Lr?i.pipe(C_):i instanceof Promise?rn(()=>new Promise((o,a)=>i.then(u=>rn(()=>o(u)),u=>rn(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:rn(()=>i)};var pt=class{constructor(e){return e}},on=class{constructor(){return Yi()}};function k_(n){return n&&n.length===1?n[0]:new pt(zn())}var Ea=new Pn("angularfire2._apps"),D_={provide:pt,useFactory:k_,deps:[[new qe,Ea]]},x_={provide:on,deps:[[new qe,Ea]]};function N_(n){return(e,t)=>{let r=t.get(kh);me("angularfire",sn.full,"core"),me("angularfire",sn.full,"app"),me("angular",qh.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new pt(i)}}function wd(n,...e){return Rn([D_,x_,{provide:Ea,useFactory:N_(n),multi:!0,deps:[kt,kn,Wn,...e]}])}var Ed=Le(Ia,!0);function Ud(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var qd=Ud,Bd=new dt("auth","Firebase",Ud());var os=new Ot("@firebase/auth");function O_(n,...e){os.logLevel<=G.WARN&&os.warn(`Auth (${Lt}): ${n}`,...e)}function ns(n,...e){os.logLevel<=G.ERROR&&os.error(`Auth (${Lt}): ${n}`,...e)}function tt(n,...e){throw Ga(n,...e)}function an(n,...e){return Ga(n,...e)}function jd(n,e,t){let r=Object.assign(Object.assign({},qd()),{[e]:t});return new dt("auth","Firebase",r).create(e,{appName:n.name})}function _t(n){return jd(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ga(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Bd.create(n,...e)}function q(n,e,...t){if(!n)throw Ga(e,...t)}function mt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw ns(e),new Error(e)}function Ut(n,e){n||mt(e)}function Sa(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function V_(){return Td()==="http:"||Td()==="https:"}function Td(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function M_(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(V_()||ed()||"connection"in navigator)?navigator.onLine:!0}function L_(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var cn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ut(t>e,"Short delay should be less than long delay!"),this.isMobile=Zh()||td()}get(){return M_()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Wa(n,e){Ut(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var as=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;mt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;mt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;mt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var F_={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var U_=new cn(3e4,6e4);function qt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Bt(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){return zd(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let I=Br(Object.assign({key:n.config.apiKey},p)).slice(1),S=yield n._getAdditionalHeaders();return S["Content-Type"]="application/json",n.languageCode&&(S["X-Firebase-Locale"]=n.languageCode),as.fetch()($d(n,n.config.apiHost,t,I),Object.assign({method:e,headers:S,referrerPolicy:"no-referrer"},d))}))})}function zd(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},F_),e);try{let i=new Ca(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw ts(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw ts(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw ts(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw ts(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw jd(n,p,d);tt(n,p)}}catch(i){if(i instanceof Me)throw i;tt(n,"network-request-failed",{message:String(i)})}})}function Zr(o,a,u,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield Bt(n,e,t,r,i);return"mfaPendingCredential"in d&&tt(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function $d(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Wa(n.config,i):`${n.config.apiScheme}://${i}`}function q_(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Ca=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(an(this.auth,"network-request-failed")),U_.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ts(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=an(n,e,r);return i.customData._tokenResponse=t,i}function bd(n){return n!==void 0&&n.enterprise!==void 0}var Pa=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return q_(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function B_(n,e){return y(this,null,function*(){return Bt(n,"GET","/v2/recaptchaConfig",qt(n,e))})}function j_(n,e){return y(this,null,function*(){return Bt(n,"POST","/v1/accounts:delete",e)})}function Gd(n,e){return y(this,null,function*(){return Bt(n,"POST","/v1/accounts:lookup",e)})}function Wr(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Ka(n,e=!1){return y(this,null,function*(){let t=Se(n),r=yield t.getIdToken(e),i=Ha(r);q(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:Wr(Ta(i.auth_time)),issuedAtTime:Wr(Ta(i.iat)),expirationTime:Wr(Ta(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function Ta(n){return Number(n)*1e3}function Ha(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return ns("JWT malformed, contained fewer than 3 sections"),null;try{let i=ta(t);return i?JSON.parse(i):(ns("Failed to decode base64 JWT payload"),null)}catch(i){return ns("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Ad(n){let e=Ha(n);return q(e,"internal-error"),q(typeof e.exp<"u","internal-error"),q(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Hr(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Me&&z_(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function z_({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Ra=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Qr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wr(this.lastLoginAt),this.creationTime=Wr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function cs(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Hr(n,Gd(t,{idToken:r}));q(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Wd(o.providerUserInfo):[],u=$_(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,I={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Qr(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,I)})}function Qa(n){return y(this,null,function*(){let e=Se(n);yield cs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function $_(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Wd(n){return n.map(e=>{var{providerId:t}=e,r=Ko(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function G_(n,e){return y(this,null,function*(){let t=yield zd(n,{},()=>y(this,null,function*(){let r=Br({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=$d(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",as.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function W_(n,e){return y(this,null,function*(){return Bt(n,"POST","/v2/accounts:revokeToken",qt(n,e))})}var Kr=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){q(e.idToken,"internal-error"),q(typeof e.idToken<"u","internal-error"),q(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ad(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){q(e.length!==0,"internal-error");let t=Ad(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(q(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield G_(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(q(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(q(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(q(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return mt("not implemented")}};function Ft(n,e){q(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Kn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=Ko(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ra(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Qr(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield Hr(this,this.stsTokenManager.getToken(this.auth,e));return q(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Ka(this,e)}reload(){return Qa(this)}_assign(e){this!==e&&(q(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield cs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(Ke(this.auth.app))return Promise.reject(_t(this.auth));let e=yield this.getIdToken();return yield Hr(this,j_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let I=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(i=t.email)!==null&&i!==void 0?i:void 0,P=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,O=(a=t.photoURL)!==null&&a!==void 0?a:void 0,F=(u=t.tenantId)!==null&&u!==void 0?u:void 0,x=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,$=(d=t.createdAt)!==null&&d!==void 0?d:void 0,K=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:H,emailVerified:ne,isAnonymous:ke,providerData:Z,stsTokenManager:w}=t;q(H&&w,e,"internal-error");let m=Kr.fromJSON(this.name,w);q(typeof H=="string",e,"internal-error"),Ft(I,e.name),Ft(S,e.name),q(typeof ne=="boolean",e,"internal-error"),q(typeof ke=="boolean",e,"internal-error"),Ft(P,e.name),Ft(O,e.name),Ft(F,e.name),Ft(x,e.name),Ft($,e.name),Ft(K,e.name);let _=new n({uid:H,auth:e,email:S,emailVerified:ne,displayName:I,isAnonymous:ke,photoURL:O,phoneNumber:P,tenantId:F,stsTokenManager:m,createdAt:$,lastLoginAt:K});return Z&&Array.isArray(Z)&&(_.providerData=Z.map(v=>Object.assign({},v))),x&&(_._redirectEventId=x),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new Kr;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield cs(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];q(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Wd(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new Kr;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Qr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var Sd=new Map;function gt(n){Ut(n instanceof Function,"Expected a class definition");let e=Sd.get(n);return e?(Ut(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Sd.set(n,e),e)}var K_=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),ka=K_;function rs(n,e,t){return`firebase:${n}:${e}:${t}`}var us=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=rs(this.userKey,i.apiKey,o),this.fullPersistenceKey=rs("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Kn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(gt(ka),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||gt(ka),a=rs(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let I=Kn._fromJSON(e,p);d!==o&&(u=I),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function Cd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Kd(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Xd(e))return"Blackberry";if(Zd(e))return"Webos";if(Hd(e))return"Safari";if((e.includes("chrome/")||Qd(e))&&!e.includes("edge/"))return"Chrome";if(Yd(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Kd(n=_e()){return/firefox\//i.test(n)}function Hd(n=_e()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qd(n=_e()){return/crios\//i.test(n)}function Jd(n=_e()){return/iemobile/i.test(n)}function Yd(n=_e()){return/android/i.test(n)}function Xd(n=_e()){return/blackberry/i.test(n)}function Zd(n=_e()){return/webos/i.test(n)}function Ja(n=_e()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function H_(n=_e()){var e;return Ja(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Q_(){return nd()&&document.documentMode===10}function ef(n=_e()){return Ja(n)||Yd(n)||Zd(n)||Xd(n)||/windows phone/i.test(n)||Jd(n)}function tf(n,e=[]){let t;switch(n){case"Browser":t=Cd(_e());break;case"Worker":t=`${Cd(_e())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Lt}/${r}`}var Da=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function J_(t){return y(this,arguments,function*(n,e={}){return Bt(n,"GET","/v2/passwordPolicy",qt(n,e))})}var Y_=6,xa=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Y_,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var Na=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ls(this),this.idTokenSubscription=new ls(this),this.beforeStateQueue=new Da(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Bd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gt(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield us.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield Gd(this,{idToken:e}),r=yield Kn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(Ke(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return q(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield cs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=L_()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(Ke(this.app))return Promise.reject(_t(this));let t=e?Se(e):null;return t&&q(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&q(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return Ke(this.app)?Promise.reject(_t(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ke(this.app)?Promise.reject(_t(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(gt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield J_(this),t=new xa(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new dt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield W_(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&gt(e)||this._popupRedirectResolver;q(t,this,"argument-error"),this.redirectPersistenceManager=yield us.create(this,[gt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(q(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&O_(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function ln(n){return Se(n)}var ls=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=od(t=>this.observer=t)}get next(){return q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var _s={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function X_(n){_s=n}function nf(n){return _s.loadJS(n)}function Z_(){return _s.recaptchaEnterpriseScript}function ey(){return _s.gapiScript}function rf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var ty="recaptcha-enterprise",ny="NO_RECAPTCHA",Oa=class{constructor(e){this.type=ty,this.auth=ln(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(o){return y(this,null,function*(){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise((a,u)=>y(this,null,function*(){B_(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new Pa(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,a(d.siteKey)}}).catch(h=>{u(h)})}))})}function i(o,a,u){let h=window.grecaptcha;bd(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{a(d)}).catch(()=>{a(ny)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,a)=>{r(this.auth).then(u=>{if(!t&&bd(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=Z_();h.length!==0&&(h+=u),nf(h).then(()=>{i(u,o,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})})}};function Pd(n,e,t,r=!1){return y(this,null,function*(){let i=new Oa(n),o;try{o=yield i.verify(t)}catch{o=yield i.verify(t,!0)}let a=Object.assign({},e);return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function Va(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let o=yield Pd(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(o=>y(this,null,function*(){if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let a=yield Pd(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(o)}))})}function Ya(n,e){let t=$r(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(tn(o,e??{}))return i;tt(i,"already-initialized")}return t.initialize({options:e})}function ry(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(gt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Xa(n,e,t){let r=ln(n);q(r._canInitEmulator,r,"emulator-config-failed"),q(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=sf(e),{host:a,port:u}=iy(e),h=u===null?"":`:${u}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||sy()}function sf(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function iy(n){let e=sf(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Rd(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:Rd(a)}}}function Rd(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function sy(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Jr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return mt("not implemented")}_getIdTokenResponse(e){return mt("not implemented")}_linkToIdToken(e,t){return mt("not implemented")}_getReauthenticationResolver(e){return mt("not implemented")}};function oy(n,e){return y(this,null,function*(){return Bt(n,"POST","/v1/accounts:signUp",e)})}function ay(n,e){return y(this,null,function*(){return Zr(n,"POST","/v1/accounts:signInWithPassword",qt(n,e))})}function cy(n,e){return y(this,null,function*(){return Zr(n,"POST","/v1/accounts:signInWithEmailLink",qt(n,e))})}function uy(n,e){return y(this,null,function*(){return Zr(n,"POST","/v1/accounts:signInWithEmailLink",qt(n,e))})}var Yr=class n extends Jr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Va(e,t,"signInWithPassword",ay);case"emailLink":return cy(e,{email:this._email,oobCode:this._password});default:tt(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Va(e,r,"signUpPassword",oy);case"emailLink":return uy(e,{idToken:t,email:this._email,oobCode:this._password});default:tt(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function ba(n,e){return y(this,null,function*(){return Zr(n,"POST","/v1/accounts:signInWithIdp",qt(n,e))})}function ly(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function hy(n){let e=Bn(jn(n)).link,t=e?Bn(jn(e)).deep_link_id:null,r=Bn(jn(n)).deep_link_id;return(r?Bn(jn(r)).link:null)||r||t||e||n}var hs=class n{constructor(e){var t,r,i,o,a,u;let h=Bn(jn(e)),d=(t=h.apiKey)!==null&&t!==void 0?t:null,p=(r=h.oobCode)!==null&&r!==void 0?r:null,I=ly((i=h.mode)!==null&&i!==void 0?i:null);q(d&&p&&I,"argument-error"),this.apiKey=d,this.operation=I,this.code=p,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=h.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=hy(e);try{return new n(t)}catch{return null}}};var of=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Yr._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=hs.parseLink(r);return q(i,"argument-error"),Yr._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),ds=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Ma=class extends ds{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function dy(n,e){return y(this,null,function*(){return Zr(n,"POST","/v1/accounts:signUp",qt(n,e))})}var Hn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield Kn._fromIdTokenResponse(e,r,i),a=kd(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=kd(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function kd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var La=class n extends Me{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function af(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?La._fromErrorAndOperation(n,o,e,r):o})}function fy(n,e,t=!1){return y(this,null,function*(){let r=yield Hr(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Hn._forOperation(n,"link",r)})}function py(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(Ke(r.app))return Promise.reject(_t(r));let i="reauthenticate";try{let o=yield Hr(n,af(r,i,e,n),t);q(o.idToken,r,"internal-error");let a=Ha(o.idToken);q(a,r,"internal-error");let{sub:u}=a;return q(n.uid===u,r,"user-mismatch"),Hn._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&tt(r,"user-mismatch"),o}})}function cf(n,e,t=!1){return y(this,null,function*(){if(Ke(n.app))return Promise.reject(_t(n));let r="signIn",i=yield af(n,r,e),o=yield Hn._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function Za(n,e){return y(this,null,function*(){return cf(ln(n),e)})}function uf(n){return y(this,null,function*(){let e=ln(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function ec(n,e,t){return y(this,null,function*(){if(Ke(n.app))return Promise.reject(_t(n));let r=ln(n),a=yield Va(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",dy).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&uf(n),h}),u=yield Hn._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(u.user),u})}function tc(n,e,t){return Ke(n.app)?Promise.reject(_t(n)):Za(Se(n),of.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&uf(n),r}))}function nc(n,e,t,r){return Se(n).onIdTokenChanged(e,t,r)}function rc(n,e,t){return Se(n).beforeAuthStateChanged(e,t)}var fs="__sak";var ps=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(fs,"1"),this.storage.removeItem(fs),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var my=1e3,gy=10,_y=(()=>{class n extends ps{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ef(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);Q_()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,gy):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},my)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Rt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Rt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Rt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),lf=_y;var yy=(()=>{class n extends ps{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),ic=yy;function vy(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Iy=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:a}=r.data,u=this.handlersMap[o];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(u).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield vy(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function hf(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Fa=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{let d=hf("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(I){let S=I;if(S.data.eventId===d)switch(S.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(S.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function et(){return window}function wy(n){et().location.href=n}function df(){return typeof et().WorkerGlobalScope<"u"&&typeof et().importScripts=="function"}function Ey(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Ty(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function by(){return df()?self:null}var ff="firebaseLocalStorageDb",Ay=1,ms="firebaseLocalStorage",pf="fbase_key",un=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function ys(n,e){return n.transaction([ms],e?"readwrite":"readonly").objectStore(ms)}function Sy(){let n=indexedDB.deleteDatabase(ff);return new un(n).toPromise()}function Ua(){let n=indexedDB.open(ff,Ay);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(ms,{keyPath:pf})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(ms)?e(r):(r.close(),yield Sy(),e(yield Ua()))}))})}function Dd(n,e,t){return y(this,null,function*(){let r=ys(n,!0).put({[pf]:e,value:t});return new un(r).toPromise()})}function Cy(n,e){return y(this,null,function*(){let t=ys(n,!1).get(e),r=yield new un(t).toPromise();return r===void 0?null:r.value})}function xd(n,e){let t=ys(n,!0).delete(e);return new un(t).toPromise()}var Py=800,Ry=3,ky=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Ua(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Ry)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return df()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=Iy._getInstance(by()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Ey(),!this.activeServiceWorker)return;this.sender=new Fa(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Ty()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Ua();return yield Dd(t,fs,"1"),yield xd(t,fs),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>Dd(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>Cy(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>xd(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let a=ys(o,!1).getAll();return new un(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),Py)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),mf=ky;var RE=rf("rcb"),kE=new cn(3e4,6e4);function Dy(n,e){return e?gt(e):(q(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Xr=class extends Jr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ba(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ba(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ba(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function xy(n){return cf(n.auth,new Xr(n),n.bypassAuthState)}function Ny(n){let{auth:e,user:t}=n;return q(t,e,"internal-error"),py(t,new Xr(n),n.bypassAuthState)}function Oy(n){return y(this,null,function*(){let{auth:e,user:t}=n;return q(t,e,"internal-error"),fy(t,new Xr(n),n.bypassAuthState)})}var qa=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xy;case"linkViaPopup":case"linkViaRedirect":return Oy;case"reauthViaPopup":case"reauthViaRedirect":return Ny;default:tt(this.auth,"internal-error")}}resolve(e){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ut(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var DE=new cn(2e3,1e4);var Vy="pendingRedirect",is=new Map,Ba=class n extends qa{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=is.get(this.auth._key());if(!e){try{let r=(yield My(this.resolver,this.auth))?yield Rt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}is.set(this.auth._key(),e)}return this.bypassAuthState||is.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Rt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Rt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function My(n,e){return y(this,null,function*(){let t=Uy(e),r=Fy(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Ly(n,e){is.set(n._key(),e)}function Fy(n){return gt(n._redirectPersistence)}function Uy(n){return rs(Vy,n.config.apiKey,n.name)}function qy(n,e,t=!1){return y(this,null,function*(){if(Ke(n.app))return Promise.reject(_t(n));let r=ln(n),i=Dy(r,e),a=yield new Ba(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var By=10*60*1e3,ja=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!jy(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!gf(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(an(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=By&&this.cachedEventUids.clear(),this.cachedEventUids.has(Nd(e))}saveEventToCache(e){this.cachedEventUids.add(Nd(e)),this.lastProcessedEventTime=Date.now()}};function Nd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function gf({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function jy(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gf(n);default:return!1}}function zy(t){return y(this,arguments,function*(n,e={}){return Bt(n,"GET","/v1/projects",e)})}var $y=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gy=/^https?/;function Wy(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield zy(n);for(let t of e)try{if(Ky(t))return}catch{}tt(n,"unauthorized-domain")})}function Ky(n){let e=Sa(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!Gy.test(t))return!1;if($y.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Hy=new cn(3e4,6e4);function Od(){let n=et().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Qy(n){return new Promise((e,t)=>{var r,i,o;function a(){Od(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Od(),t(an(n,"network-request-failed"))},timeout:Hy.get()})}if(!((i=(r=et().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=et().gapi)===null||o===void 0)&&o.load)a();else{let u=rf("iframefcb");return et()[u]=()=>{gapi.load?a():t(an(n,"network-request-failed"))},nf(`${ey()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw ss=null,e})}var ss=null;function Jy(n){return ss=ss||Qy(n),ss}var Yy=new cn(5e3,15e3),Xy="__/auth/iframe",Zy="emulator/auth/iframe",e0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},t0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function n0(n){let e=n.config;q(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Wa(e,Zy):`https://${n.config.authDomain}/${Xy}`,r={apiKey:e.apiKey,appName:n.name,v:Lt},i=t0.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Br(r).slice(1)}`}function r0(n){return y(this,null,function*(){let e=yield Jy(n),t=et().gapi;return q(t,n,"internal-error"),e.open({where:document.body,url:n0(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:e0,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=an(n,"network-request-failed"),u=et().setTimeout(()=>{o(a)},Yy.get());function h(){et().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})})))})}var i0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},s0=500,o0=600,a0="_blank",c0="http://localhost",gs=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function u0(n,e,t,r=s0,i=o0){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},i0),{width:r.toString(),height:i.toString(),top:o,left:a}),d=_e().toLowerCase();t&&(u=Qd(d)?a0:t),Kd(d)&&(e=e||c0,h.scrollbars="yes");let p=Object.entries(h).reduce((S,[P,O])=>`${S}${P}=${O},`,"");if(H_(d)&&u!=="_self")return l0(e||"",u),new gs(null);let I=window.open(e||"",u,p);q(I,n,"popup-blocked");try{I.focus()}catch{}return new gs(I)}function l0(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var h0="__/auth/handler",d0="emulator/auth/handler",f0=encodeURIComponent("fac");function Vd(n,e,t,r,i,o){return y(this,null,function*(){q(n.config.authDomain,n,"auth-domain-config-required"),q(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Lt,eventId:i};if(e instanceof ds){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",sd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,I]of Object.entries(o||{}))a[p]=I}if(e instanceof Ma){let p=e.getScopes().filter(I=>I!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let h=yield n._getAppCheckToken(),d=h?`#${f0}=${encodeURIComponent(h)}`:"";return`${p0(n)}?${Br(u).slice(1)}${d}`})}function p0({config:n}){return n.emulator?Wa(n,d0):`https://${n.authDomain}/${h0}`}var Aa="webStorageSupport",za=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ic,this._completeRedirectFn=qy,this._overrideRedirectResult=Ly}_openPopup(e,t,r,i){return y(this,null,function*(){var o;Ut((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=yield Vd(e,t,r,Sa(),i);return u0(e,a,hf())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield Vd(e,t,r,Sa(),i);return wy(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Ut(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield r0(e),r=new ja(e);return t.register("authEvent",i=>(q(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Aa,{type:Aa},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[Aa];a!==void 0&&t(!!a),tt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Wy(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ef()||Hd()||Ja()}},_f=za;var Md="@firebase/auth",Ld="1.7.8";var $a=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function m0(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function g0(n){Mt(new ze("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;q(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tf(n)},d=new Na(r,i,o,h);return ry(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Mt(new ze("auth-internal",e=>{let t=ln(e.getProvider("auth").getImmediate());return(r=>new $a(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),me(Md,Ld,m0(n)),me(Md,Ld,"esm2017")}var _0=5*60,y0=ia("authIdTokenMaxAge")||_0,Fd=null,v0=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>y0)return;let i=t?.token;Fd!==i&&(Fd=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function sc(n=zn()){let e=$r(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Ya(n,{popupRedirectResolver:_f,persistence:[mf,lf,ic]}),r=ia("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=v0(o.toString());rc(t,a,()=>a(t.currentUser)),nc(t,u=>a(u))}}let i=na("auth");return i&&Xa(t,`http://${i}`),t}function I0(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}X_({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=an("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",I0().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});g0("Browser");var yf="auth",He=class{constructor(e){return e}},ei=class{constructor(){return Gr(yf)}};var oc=new Pn("angularfire2.auth-instances");function hv(n,e){let t=Zi(yf,n,e);return t&&new He(t)}function dv(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new He(r)}}var fv={provide:ei,deps:[[new qe,oc]]},pv={provide:He,useFactory:hv,deps:[[new qe,oc],pt]};function vf(n,...e){return me("angularfire",sn.full,"auth"),Rn([pv,fv,{provide:oc,useFactory:dv(n),multi:!0,deps:[kt,kn,Wn,on,[new qe,Gn],...e]}])}var If=Le(ec,!0);var wf=Le(sc,!0);var Ef=Le(tc,!0);var Tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bf={};var jt,cc;(function(){var n;function e(w,m){function _(){}_.prototype=m.prototype,w.D=m.prototype,w.prototype=new _,w.prototype.constructor=w,w.C=function(v,E,b){for(var g=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)g[ct-2]=arguments[ct];return m.prototype[E].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)v[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)v[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=w.g[0],_=w.g[1],E=w.g[2];var b=w.g[3],g=m+(b^_&(E^b))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[1]+3905402710&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[2]+606105819&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(b^_&(E^b))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[5]+1200080426&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[6]+2821735955&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(b^_&(E^b))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[9]+2336552879&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[10]+4294925233&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(b^_&(E^b))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=b+(E^m&(_^E))+v[13]+4254626195&4294967295,b=m+(g<<12&4294967295|g>>>20),g=E+(_^b&(m^_))+v[14]+2792965006&4294967295,E=b+(g<<17&4294967295|g>>>15),g=_+(m^E&(b^m))+v[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^b&(_^E))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[6]+3225465664&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[11]+643717713&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^b&(_^E))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[10]+38016083&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[15]+3634488961&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^b&(_^E))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[14]+3275163606&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[3]+4107603335&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^b&(_^E))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=b+(_^E&(m^_))+v[2]+4243563512&4294967295,b=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(b^m))+v[7]+1735328473&4294967295,E=b+(g<<14&4294967295|g>>>18),g=_+(b^m&(E^b))+v[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^b)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[8]+2272392833&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[11]+1839030562&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^b)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[4]+1272893353&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[7]+4139469664&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^b)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[0]+3936430074&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[3]+3572445317&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^b)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=b+(m^_^E)+v[12]+3873151461&4294967295,b=m+(g<<11&4294967295|g>>>21),g=E+(b^m^_)+v[15]+530742520&4294967295,E=b+(g<<16&4294967295|g>>>16),g=_+(E^b^m)+v[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~b))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[7]+1126891415&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[14]+2878612391&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~b))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[3]+2399980690&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[10]+4293915773&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~b))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[15]+4264355552&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[6]+2734768916&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~b))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=b+(_^(m|~E))+v[11]+3174756917&4294967295,b=m+(g<<10&4294967295|g>>>22),g=E+(m^(b|~_))+v[2]+718787259&4294967295,E=b+(g<<15&4294967295|g>>>17),g=_+(b^(E|~m))+v[9]+3951481745&4294967295,w.g[0]=w.g[0]+m&4294967295,w.g[1]=w.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+b&4294967295}r.prototype.u=function(w,m){m===void 0&&(m=w.length);for(var _=m-this.blockSize,v=this.B,E=this.h,b=0;b<m;){if(E==0)for(;b<=_;)i(this,w,b),b+=this.blockSize;if(typeof w=="string"){for(;b<m;)if(v[E++]=w.charCodeAt(b++),E==this.blockSize){i(this,v),E=0;break}}else for(;b<m;)if(v[E++]=w[b++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var m=1;m<w.length-8;++m)w[m]=0;var _=8*this.o;for(m=w.length-8;m<w.length;++m)w[m]=_&255,_/=256;for(this.u(w),w=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)w[_++]=this.g[m]>>>v&255;return w};function o(w,m){var _=u;return Object.prototype.hasOwnProperty.call(_,w)?_[w]:_[w]=m(w)}function a(w,m){this.h=m;for(var _=[],v=!0,E=w.length-1;0<=E;E--){var b=w[E]|0;v&&b==m||(_[E]=b,v=!1)}this.g=_}var u={};function h(w){return-128<=w&&128>w?o(w,function(m){return new a([m|0],0>m?-1:0)}):new a([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return I;if(0>w)return x(d(-w));for(var m=[],_=1,v=0;w>=_;v++)m[v]=w/_|0,_*=4294967296;return new a(m,0)}function p(w,m){if(w.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(w.charAt(0)=="-")return x(p(w.substring(1),m));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=I,E=0;E<w.length;E+=8){var b=Math.min(8,w.length-E),g=parseInt(w.substring(E,E+b),m);8>b?(b=d(Math.pow(m,b)),v=v.j(b).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var I=h(0),S=h(1),P=h(16777216);n=a.prototype,n.m=function(){if(F(this))return-x(this).m();for(var w=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);w+=(0<=v?v:4294967296+v)*m,m*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(O(this))return"0";if(F(this))return"-"+x(this).toString(w);for(var m=d(Math.pow(w,6)),_=this,v="";;){var E=ne(_,m).g;_=$(_,E.j(m));var b=((0<_.g.length?_.g[0]:_.h)>>>0).toString(w);if(_=E,O(_))return b+v;for(;6>b.length;)b="0"+b;v=b+v}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function O(w){if(w.h!=0)return!1;for(var m=0;m<w.g.length;m++)if(w.g[m]!=0)return!1;return!0}function F(w){return w.h==-1}n.l=function(w){return w=$(this,w),F(w)?-1:O(w)?0:1};function x(w){for(var m=w.g.length,_=[],v=0;v<m;v++)_[v]=~w.g[v];return new a(_,~w.h).add(S)}n.abs=function(){return F(this)?x(this):this},n.add=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0,E=0;E<=m;E++){var b=v+(this.i(E)&65535)+(w.i(E)&65535),g=(b>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);v=g>>>16,b&=65535,g&=65535,_[E]=g<<16|b}return new a(_,_[_.length-1]&-2147483648?-1:0)};function $(w,m){return w.add(x(m))}n.j=function(w){if(O(this)||O(w))return I;if(F(this))return F(w)?x(this).j(x(w)):x(x(this).j(w));if(F(w))return x(this.j(x(w)));if(0>this.l(P)&&0>w.l(P))return d(this.m()*w.m());for(var m=this.g.length+w.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<w.g.length;E++){var b=this.i(v)>>>16,g=this.i(v)&65535,ct=w.i(E)>>>16,yr=w.i(E)&65535;_[2*v+2*E]+=g*yr,K(_,2*v+2*E),_[2*v+2*E+1]+=b*yr,K(_,2*v+2*E+1),_[2*v+2*E+1]+=g*ct,K(_,2*v+2*E+1),_[2*v+2*E+2]+=b*ct,K(_,2*v+2*E+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function K(w,m){for(;(w[m]&65535)!=w[m];)w[m+1]+=w[m]>>>16,w[m]&=65535,m++}function H(w,m){this.g=w,this.h=m}function ne(w,m){if(O(m))throw Error("division by zero");if(O(w))return new H(I,I);if(F(w))return m=ne(x(w),m),new H(x(m.g),x(m.h));if(F(m))return m=ne(w,x(m)),new H(x(m.g),m.h);if(30<w.g.length){if(F(w)||F(m))throw Error("slowDivide_ only works with positive integers.");for(var _=S,v=m;0>=v.l(w);)_=ke(_),v=ke(v);var E=Z(_,1),b=Z(v,1);for(v=Z(v,2),_=Z(_,2);!O(v);){var g=b.add(v);0>=g.l(w)&&(E=E.add(_),b=g),v=Z(v,1),_=Z(_,1)}return m=$(w,E.j(m)),new H(E,m)}for(E=I;0<=w.l(m);){for(_=Math.max(1,Math.floor(w.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),b=d(_),g=b.j(m);F(g)||0<g.l(w);)_-=v,b=d(_),g=b.j(m);O(b)&&(b=S),E=E.add(b),w=$(w,g)}return new H(E,w)}n.A=function(w){return ne(this,w).h},n.and=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&w.i(v);return new a(_,this.h&w.h)},n.or=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|w.i(v);return new a(_,this.h|w.h)},n.xor=function(w){for(var m=Math.max(this.g.length,w.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^w.i(v);return new a(_,this.h^w.h)};function ke(w){for(var m=w.g.length+1,_=[],v=0;v<m;v++)_[v]=w.i(v)<<1|w.i(v-1)>>>31;return new a(_,w.h)}function Z(w,m){var _=m>>5;m%=32;for(var v=w.g.length-_,E=[],b=0;b<v;b++)E[b]=0<m?w.i(b+_)>>>m|w.i(b+_+1)<<32-m:w.i(b+_);return new a(E,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,cc=bf.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,jt=bf.Integer=a}).apply(typeof Tf<"u"?Tf:typeof self<"u"?self:typeof window<"u"?window:{});var vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yt={};var uc,lc,Qn,hc,ti,Is,dc,fc,pc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof vs=="object"&&vs];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var T=s[f];if(!(T in l))break e;l=l[T]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,T={next:function(){if(!f&&l<s.length){var A=l++;return{value:c(A,s[A]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function I(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),s.apply(c,T)}}return function(){return s.apply(c,arguments)}}function S(s,c,l){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:I,S.apply(null,arguments)}function P(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function O(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,T,A){for(var D=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)D[ee-2]=arguments[ee];return c.prototype[T].apply(f,D)}}function F(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function x(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let T=s.length||0,A=f.length||0;s.length=T+A;for(let D=0;D<A;D++)s[T+D]=f[D]}else s.push(f)}}class ${constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function K(s){return/^[\s\xa0]*$/.test(s)}function H(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ne(s){return ne[" "](s),s}ne[" "]=function(){};var ke=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function Z(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function w(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,c){let l,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(l in f)s[l]=f[l];for(let A=0;A<_.length;A++)l=_[A],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function b(s){u.setTimeout(()=>{throw s},0)}function g(){var s=Eo;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class ct{constructor(){this.h=this.g=null}add(c,l){let f=yr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var yr=new $(()=>new Rm,s=>s.reset());class Rm{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let vr,Ir=!1,Eo=new ct,El=()=>{let s=u.Promise.resolve(void 0);vr=()=>{s.then(km)}};var km=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){b(l)}var c=yr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}Ir=!1};function At(){this.s=this.s,this.C=this.C}At.prototype.s=!1,At.prototype.ma=function(){this.s||(this.s=!0,this.N())},At.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ie(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}Ie.prototype.h=function(){this.defaultPrevented=!0};var Dm=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s}();function wr(s,c){if(Ie.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(ke){e:{try{ne(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:xm[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&wr.aa.h.call(this)}}O(wr,Ie);var xm={2:"touch",3:"pen",4:"mouse"};wr.prototype.h=function(){wr.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Er="closure_listenable_"+(1e6*Math.random()|0),Nm=0;function Om(s,c,l,f,T){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=T,this.key=++Nm,this.da=this.fa=!1}function Ai(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Si(s){this.src=s,this.g={},this.h=0}Si.prototype.add=function(s,c,l,f,T){var A=s.toString();s=this.g[A],s||(s=this.g[A]=[],this.h++);var D=bo(s,c,f,T);return-1<D?(c=s[D],l||(c.fa=!1)):(c=new Om(c,this.src,A,!!f,T),c.fa=l,s.push(c)),c};function To(s,c){var l=c.type;if(l in s.g){var f=s.g[l],T=Array.prototype.indexOf.call(f,c,void 0),A;(A=0<=T)&&Array.prototype.splice.call(f,T,1),A&&(Ai(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function bo(s,c,l,f){for(var T=0;T<s.length;++T){var A=s[T];if(!A.da&&A.listener==c&&A.capture==!!l&&A.ha==f)return T}return-1}var Ao="closure_lm_"+(1e6*Math.random()|0),So={};function Tl(s,c,l,f,T){if(f&&f.once)return Al(s,c,l,f,T);if(Array.isArray(c)){for(var A=0;A<c.length;A++)Tl(s,c[A],l,f,T);return null}return l=ko(l),s&&s[Er]?s.K(c,l,d(f)?!!f.capture:!!f,T):bl(s,c,l,!1,f,T)}function bl(s,c,l,f,T,A){if(!c)throw Error("Invalid event type");var D=d(T)?!!T.capture:!!T,ee=Po(s);if(ee||(s[Ao]=ee=new Si(s)),l=ee.add(c,l,f,D,A),l.proxy)return l;if(f=Vm(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)Dm||(T=D),T===void 0&&(T=!1),s.addEventListener(c.toString(),f,T);else if(s.attachEvent)s.attachEvent(Cl(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Vm(){function s(l){return c.call(s.src,s.listener,l)}let c=Mm;return s}function Al(s,c,l,f,T){if(Array.isArray(c)){for(var A=0;A<c.length;A++)Al(s,c[A],l,f,T);return null}return l=ko(l),s&&s[Er]?s.L(c,l,d(f)?!!f.capture:!!f,T):bl(s,c,l,!0,f,T)}function Sl(s,c,l,f,T){if(Array.isArray(c))for(var A=0;A<c.length;A++)Sl(s,c[A],l,f,T);else f=d(f)?!!f.capture:!!f,l=ko(l),s&&s[Er]?(s=s.i,c=String(c).toString(),c in s.g&&(A=s.g[c],l=bo(A,l,f,T),-1<l&&(Ai(A[l]),Array.prototype.splice.call(A,l,1),A.length==0&&(delete s.g[c],s.h--)))):s&&(s=Po(s))&&(c=s.g[c.toString()],s=-1,c&&(s=bo(c,l,f,T)),(l=-1<s?c[s]:null)&&Co(l))}function Co(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[Er])To(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(Cl(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=Po(c))?(To(l,s),l.h==0&&(l.src=null,c[Ao]=null)):Ai(s)}}}function Cl(s){return s in So?So[s]:So[s]="on"+s}function Mm(s,c){if(s.da)s=!0;else{c=new wr(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&Co(s),s=l.call(f,c)}return s}function Po(s){return s=s[Ao],s instanceof Si?s:null}var Ro="__closure_events_fn_"+(1e9*Math.random()>>>0);function ko(s){return typeof s=="function"?s:(s[Ro]||(s[Ro]=function(c){return s.handleEvent(c)}),s[Ro])}function we(){At.call(this),this.i=new Si(this),this.M=this,this.F=null}O(we,At),we.prototype[Er]=!0,we.prototype.removeEventListener=function(s,c,l,f){Sl(this,s,c,l,f)};function De(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new Ie(c,s);else if(c instanceof Ie)c.target=c.target||s;else{var T=c;c=new Ie(f,s),v(c,T)}if(T=!0,l)for(var A=l.length-1;0<=A;A--){var D=c.g=l[A];T=Ci(D,f,!0,c)&&T}if(D=c.g=s,T=Ci(D,f,!0,c)&&T,T=Ci(D,f,!1,c)&&T,l)for(A=0;A<l.length;A++)D=c.g=l[A],T=Ci(D,f,!1,c)&&T}we.prototype.N=function(){if(we.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)Ai(l[f]);delete s.g[c],s.h--}}this.F=null},we.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},we.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function Ci(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,A=0;A<c.length;++A){var D=c[A];if(D&&!D.da&&D.capture==l){var ee=D.listener,ve=D.ha||D.src;D.fa&&To(s.i,D),T=ee.call(ve,f)!==!1&&T}}return T&&!f.defaultPrevented}function Pl(s,c,l){if(typeof s=="function")l&&(s=S(s,l));else if(s&&typeof s.handleEvent=="function")s=S(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function Rl(s){s.g=Pl(()=>{s.g=null,s.i&&(s.i=!1,Rl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Lm extends At{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Rl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tr(s){At.call(this),this.h=s,this.g={}}O(Tr,At);var kl=[];function Dl(s){Z(s.g,function(c,l){this.g.hasOwnProperty(l)&&Co(c)},s),s.g={}}Tr.prototype.N=function(){Tr.aa.N.call(this),Dl(this)},Tr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Do=u.JSON.stringify,Fm=u.JSON.parse,Um=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function xo(){}xo.prototype.h=null;function xl(s){return s.h||(s.h=s.i())}function Nl(){}var br={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function No(){Ie.call(this,"d")}O(No,Ie);function Oo(){Ie.call(this,"c")}O(Oo,Ie);var Ht={},Ol=null;function Pi(){return Ol=Ol||new we}Ht.La="serverreachability";function Vl(s){Ie.call(this,Ht.La,s)}O(Vl,Ie);function Ar(s){let c=Pi();De(c,new Vl(c))}Ht.STAT_EVENT="statevent";function Ml(s,c){Ie.call(this,Ht.STAT_EVENT,s),this.stat=c}O(Ml,Ie);function xe(s){let c=Pi();De(c,new Ml(c,s))}Ht.Ma="timingevent";function Ll(s,c){Ie.call(this,Ht.Ma,s),this.size=c}O(Ll,Ie);function Sr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function Cr(){this.g=!0}Cr.prototype.xa=function(){this.g=!1};function qm(s,c,l,f,T,A){s.info(function(){if(s.g)if(A)for(var D="",ee=A.split("&"),ve=0;ve<ee.length;ve++){var Y=ee[ve].split("=");if(1<Y.length){var Ee=Y[0];Y=Y[1];var Te=Ee.split("_");D=2<=Te.length&&Te[1]=="type"?D+(Ee+"="+Y+"&"):D+(Ee+"=redacted&")}}else D=null;else D=A;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+l+`
`+D})}function Bm(s,c,l,f,T,A,D){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+l+`
`+A+" "+D})}function bn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+zm(s,l)+(f?" "+f:"")})}function jm(s,c){s.info(function(){return"TIMEOUT: "+c})}Cr.prototype.info=function(){};function zm(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var A=T[0];if(A!="noop"&&A!="stop"&&A!="close")for(var D=1;D<T.length;D++)T[D]=""}}}}return Do(l)}catch{return c}}var Ri={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Vo;function ki(){}O(ki,xo),ki.prototype.g=function(){return new XMLHttpRequest},ki.prototype.i=function(){return{}},Vo=new ki;function St(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new Tr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ul}function Ul(){this.i=null,this.g="",this.h=!1}var ql={},Mo={};function Lo(s,c,l){s.L=1,s.v=Oi(ut(c)),s.m=l,s.P=!0,Bl(s,null)}function Bl(s,c){s.F=Date.now(),Di(s),s.A=ut(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),th(l.i,"t",f),s.C=0,l=s.j.J,s.h=new Ul,s.g=vh(s.j,l?c:null,!s.m),0<s.O&&(s.M=new Lm(S(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var T="readystatechange";Array.isArray(T)||(T&&(kl[0]=T.toString()),T=kl);for(var A=0;A<T.length;A++){var D=Tl(l,T[A],f||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),Ar(),qm(s.i,s.u,s.A,s.l,s.R,s.m)}St.prototype.ca=function(s){s=s.target;let c=this.M;c&&lt(s)==3?c.j():this.Y(s)},St.prototype.Y=function(s){try{if(s==this.g)e:{let Te=lt(this.g);var c=this.g.Ba();let Cn=this.g.Z();if(!(3>Te)&&(Te!=3||this.g&&(this.h.h||this.g.oa()||ch(this.g)))){this.J||Te!=4||c==7||(c==8||0>=Cn?Ar(3):Ar(2)),Fo(this);var l=this.g.Z();this.X=l;t:if(jl(this)){var f=ch(this.g);s="";var T=f.length,A=lt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qt(this),Pr(this);var D="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(A&&c==T-1)});f.length=0,this.h.g+=s,this.C=0,D=this.h.g}else D=this.g.oa();if(this.o=l==200,Bm(this.i,this.u,this.A,this.l,this.R,Te,l),this.o){if(this.T&&!this.K){t:{if(this.g){var ee,ve=this.g;if((ee=ve.g?ve.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(ee)){var Y=ee;break t}}Y=null}if(l=Y)bn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Uo(this,l);else{this.o=!1,this.s=3,xe(12),Qt(this),Pr(this);break e}}if(this.P){l=!0;let $e;for(;!this.J&&this.C<D.length;)if($e=$m(this,D),$e==Mo){Te==4&&(this.s=4,xe(14),l=!1),bn(this.i,this.l,null,"[Incomplete Response]");break}else if($e==ql){this.s=4,xe(15),bn(this.i,this.l,D,"[Invalid Chunk]"),l=!1;break}else bn(this.i,this.l,$e,null),Uo(this,$e);if(jl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Te!=4||D.length!=0||this.h.h||(this.s=1,xe(16),l=!1),this.o=this.o&&l,!l)bn(this.i,this.l,D,"[Invalid Chunked Response]"),Qt(this),Pr(this);else if(0<D.length&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.ba&&!Ee.M&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),Go(Ee),Ee.M=!0,xe(11))}}else bn(this.i,this.l,D,null),Uo(this,D);Te==4&&Qt(this),this.o&&!this.J&&(Te==4?mh(this.j,this):(this.o=!1,Di(this)))}else ag(this.g),l==400&&0<D.indexOf("Unknown SID")?(this.s=3,xe(12)):(this.s=0,xe(13)),Qt(this),Pr(this)}}}catch{}finally{}};function jl(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function $m(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?Mo:(l=Number(c.substring(l,f)),isNaN(l)?ql:(f+=1,f+l>c.length?Mo:(c=c.slice(f,f+l),s.C=f+l,c)))}St.prototype.cancel=function(){this.J=!0,Qt(this)};function Di(s){s.S=Date.now()+s.I,zl(s,s.I)}function zl(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Sr(S(s.ba,s),c)}function Fo(s){s.B&&(u.clearTimeout(s.B),s.B=null)}St.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(jm(this.i,this.A),this.L!=2&&(Ar(),xe(17)),Qt(this),this.s=2,Pr(this)):zl(this,this.S-s)};function Pr(s){s.j.G==0||s.J||mh(s.j,s)}function Qt(s){Fo(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,Dl(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function Uo(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||qo(l.h,s))){if(!s.K&&qo(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)Ui(l),Li(l);else break e;$o(l),xe(18)}}else l.za=T[1],0<l.za-l.T&&37500>T[2]&&l.F&&l.v==0&&!l.C&&(l.C=Sr(S(l.Za,l),6e3));if(1>=Wl(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else Yt(l,11)}else if((s.K||l.g==s)&&Ui(l),!K(c))for(T=l.Da.g.parse(c),c=0;c<T.length;c++){let Y=T[c];if(l.T=Y[0],Y=Y[1],l.G==2)if(Y[0]=="c"){l.K=Y[1],l.ia=Y[2];let Ee=Y[3];Ee!=null&&(l.la=Ee,l.j.info("VER="+l.la));let Te=Y[4];Te!=null&&(l.Aa=Te,l.j.info("SVER="+l.Aa));let Cn=Y[5];Cn!=null&&typeof Cn=="number"&&0<Cn&&(f=1.5*Cn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let $e=s.g;if($e){let Bi=$e.g?$e.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bi){var A=f.h;A.g||Bi.indexOf("spdy")==-1&&Bi.indexOf("quic")==-1&&Bi.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(Bo(A,A.h),A.h=null))}if(f.D){let Wo=$e.g?$e.g.getResponseHeader("X-HTTP-Session-Id"):null;Wo&&(f.ya=Wo,re(f.I,f.D,Wo))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var D=s;if(f.qa=yh(f,f.J?f.ia:null,f.W),D.K){Kl(f.h,D);var ee=D,ve=f.L;ve&&(ee.I=ve),ee.B&&(Fo(ee),Di(ee)),f.g=D}else fh(f);0<l.i.length&&Fi(l)}else Y[0]!="stop"&&Y[0]!="close"||Yt(l,7);else l.G==3&&(Y[0]=="stop"||Y[0]=="close"?Y[0]=="stop"?Yt(l,7):zo(l):Y[0]!="noop"&&l.l&&l.l.ta(Y),l.v=0)}}Ar(4)}catch{}}var Gm=class{constructor(s,c){this.g=s,this.map=c}};function $l(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gl(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Wl(s){return s.h?1:s.g?s.g.size:0}function qo(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function Bo(s,c){s.g?s.g.add(c):s.h=c}function Kl(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}$l.prototype.cancel=function(){if(this.i=Hl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Hl(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return F(s.i)}function Wm(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function Km(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function Ql(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=Km(s),f=Wm(s),T=f.length,A=0;A<T;A++)c.call(void 0,f[A],l&&l[A],s)}var Jl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hm(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),T=null;if(0<=f){var A=s[l].substring(0,f);T=s[l].substring(f+1)}else A=s[l];c(A,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Jt(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Jt){this.h=s.h,xi(this,s.j),this.o=s.o,this.g=s.g,Ni(this,s.s),this.l=s.l;var c=s.i,l=new Dr;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),Yl(this,l),this.m=s.m}else s&&(c=String(s).match(Jl))?(this.h=!1,xi(this,c[1]||"",!0),this.o=Rr(c[2]||""),this.g=Rr(c[3]||"",!0),Ni(this,c[4]),this.l=Rr(c[5]||"",!0),Yl(this,c[6]||"",!0),this.m=Rr(c[7]||"")):(this.h=!1,this.i=new Dr(null,this.h))}Jt.prototype.toString=function(){var s=[],c=this.j;c&&s.push(kr(c,Xl,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(kr(c,Xl,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(kr(l,l.charAt(0)=="/"?Ym:Jm,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",kr(l,Zm)),s.join("")};function ut(s){return new Jt(s)}function xi(s,c,l){s.j=l?Rr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Ni(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Yl(s,c,l){c instanceof Dr?(s.i=c,eg(s.i,s.h)):(l||(c=kr(c,Xm)),s.i=new Dr(c,s.h))}function re(s,c,l){s.i.set(c,l)}function Oi(s){return re(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Rr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function kr(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,Qm),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function Qm(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Xl=/[#\/\?@]/g,Jm=/[#\?:]/g,Ym=/[#\?]/g,Xm=/[#\?@]/g,Zm=/#/g;function Dr(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Ct(s){s.g||(s.g=new Map,s.h=0,s.i&&Hm(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=Dr.prototype,n.add=function(s,c){Ct(this),this.i=null,s=An(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function Zl(s,c){Ct(s),c=An(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function eh(s,c){return Ct(s),c=An(s,c),s.g.has(c)}n.forEach=function(s,c){Ct(this),this.g.forEach(function(l,f){l.forEach(function(T){s.call(c,T,f,this)},this)},this)},n.na=function(){Ct(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let T=s[f];for(let A=0;A<T.length;A++)l.push(c[f])}return l},n.V=function(s){Ct(this);let c=[];if(typeof s=="string")eh(this,s)&&(c=c.concat(this.g.get(An(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return Ct(this),this.i=null,s=An(this,s),eh(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function th(s,c,l){Zl(s,c),0<l.length&&(s.i=null,s.g.set(An(s,c),F(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let A=encodeURIComponent(String(f)),D=this.V(f);for(f=0;f<D.length;f++){var T=A;D[f]!==""&&(T+="="+encodeURIComponent(String(D[f]))),s.push(T)}}return this.i=s.join("&")};function An(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function eg(s,c){c&&!s.j&&(Ct(s),s.i=null,s.g.forEach(function(l,f){var T=f.toLowerCase();f!=T&&(Zl(this,f),th(this,T,l))},s)),s.j=c}function tg(s,c){let l=new Cr;if(u.Image){let f=new Image;f.onload=P(Pt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=P(Pt,l,"TestLoadImage: error",!1,c,f),f.onabort=P(Pt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=P(Pt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function ng(s,c){let l=new Cr,f=new AbortController,T=setTimeout(()=>{f.abort(),Pt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(A=>{clearTimeout(T),A.ok?Pt(l,"TestPingServer: ok",!0,c):Pt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),Pt(l,"TestPingServer: error",!1,c)})}function Pt(s,c,l,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(l)}catch{}}function rg(){this.g=new Um}function ig(s,c,l){let f=l||"";try{Ql(s,function(T,A){let D=T;d(T)&&(D=Do(T)),c.push(f+A+"="+encodeURIComponent(D))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function xr(s){this.l=s.Ub||null,this.j=s.eb||!1}O(xr,xo),xr.prototype.g=function(){return new Vi(this.l,this.j)},xr.prototype.i=function(s){return function(){return s}}({});function Vi(s,c){we.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}O(Vi,we),n=Vi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Or(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Nr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Or(this)),this.g&&(this.readyState=3,Or(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;nh(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function nh(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?Nr(this):Or(this),this.readyState==3&&nh(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,Nr(this))},n.Qa=function(s){this.g&&(this.response=s,Nr(this))},n.ga=function(){this.g&&Nr(this)};function Nr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Or(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Or(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(Vi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function rh(s){let c="";return Z(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function jo(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=rh(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):re(s,c,l))}function ae(s){we.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}O(ae,we);var sg=/^https?$/i,og=["POST","PUT"];n=ae.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vo.g(),this.v=this.o?xl(this.o):xl(Vo),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(A){ih(this,A);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)l.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let A of f.keys())l.set(A,f.get(A));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(A=>A.toLowerCase()=="content-type"),T=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(og,c,void 0))||f||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,D]of l)this.g.setRequestHeader(A,D);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ah(this),this.u=!0,this.g.send(s),this.u=!1}catch(A){ih(this,A)}};function ih(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,sh(s),Mi(s)}function sh(s){s.A||(s.A=!0,De(s,"complete"),De(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,De(this,"complete"),De(this,"abort"),Mi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mi(this,!0)),ae.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?oh(this):this.bb())},n.bb=function(){oh(this)};function oh(s){if(s.h&&typeof a<"u"&&(!s.v[1]||lt(s)!=4||s.Z()!=2)){if(s.u&&lt(s)==4)Pl(s.Ea,0,s);else if(De(s,"readystatechange"),lt(s)==4){s.h=!1;try{let D=s.Z();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=D===0){var T=String(s.D).match(Jl)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!sg.test(T?T.toLowerCase():"")}l=f}if(l)De(s,"complete"),De(s,"success");else{s.m=6;try{var A=2<lt(s)?s.g.statusText:""}catch{A=""}s.l=A+" ["+s.Z()+"]",sh(s)}}finally{Mi(s)}}}}function Mi(s,c){if(s.g){ah(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||De(s,"ready");try{l.onreadystatechange=f}catch{}}}function ah(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function lt(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<lt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Fm(c)}};function ch(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function ag(s){let c={};s=(s.g&&2<=lt(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(K(s[f]))continue;var l=E(s[f]);let T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let A=c[T]||[];c[T]=A,A.push(l)}w(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function uh(s){this.Aa=0,this.i=[],this.j=new Cr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vr("baseRetryDelayMs",5e3,s),this.cb=Vr("retryDelaySeedMs",1e4,s),this.Wa=Vr("forwardChannelMaxRetries",2,s),this.wa=Vr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new $l(s&&s.concurrentRequestLimit),this.Da=new rg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=uh.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){xe(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=yh(this,null,this.W),Fi(this)};function zo(s){if(lh(s),s.G==3){var c=s.U++,l=ut(s.I);if(re(l,"SID",s.K),re(l,"RID",c),re(l,"TYPE","terminate"),Mr(s,l),c=new St(s,s.j,c),c.L=2,c.v=Oi(ut(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=vh(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Di(c)}_h(s)}function Li(s){s.g&&(Go(s),s.g.cancel(),s.g=null)}function lh(s){Li(s),s.u&&(u.clearTimeout(s.u),s.u=null),Ui(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function Fi(s){if(!Gl(s.h)&&!s.s){s.s=!0;var c=s.Ga;vr||El(),Ir||(vr(),Ir=!0),Eo.add(c,s),s.B=0}}function cg(s,c){return Wl(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Sr(S(s.Ga,s,c),gh(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let T=new St(this,this.j,s),A=this.o;if(this.S&&(A?(A=m(A),v(A,this.S)):A=this.S),this.m!==null||this.O||(T.H=A,A=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=dh(this,T,c),l=ut(this.I),re(l,"RID",s),re(l,"CVER",22),this.D&&re(l,"X-HTTP-Session-Id",this.D),Mr(this,l),A&&(this.O?c="headers="+encodeURIComponent(String(rh(A)))+"&"+c:this.m&&jo(l,this.m,A)),Bo(this.h,T),this.Ua&&re(l,"TYPE","init"),this.P?(re(l,"$req",c),re(l,"SID","null"),T.T=!0,Lo(T,l,null)):Lo(T,l,c),this.G=2}}else this.G==3&&(s?hh(this,s):this.i.length==0||Gl(this.h)||hh(this))};function hh(s,c){var l;c?l=c.l:l=s.U++;let f=ut(s.I);re(f,"SID",s.K),re(f,"RID",l),re(f,"AID",s.T),Mr(s,f),s.m&&s.o&&jo(f,s.m,s.o),l=new St(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=dh(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),Bo(s.h,l),Lo(l,f,c)}function Mr(s,c){s.H&&Z(s.H,function(l,f){re(c,f,l)}),s.l&&Ql({},function(l,f){re(c,f,l)})}function dh(s,c,l){l=Math.min(s.i.length,l);var f=s.l?S(s.l.Na,s.l,s):null;e:{var T=s.i;let A=-1;for(;;){let D=["count="+l];A==-1?0<l?(A=T[0].g,D.push("ofs="+A)):A=0:D.push("ofs="+A);let ee=!0;for(let ve=0;ve<l;ve++){let Y=T[ve].g,Ee=T[ve].map;if(Y-=A,0>Y)A=Math.max(0,T[ve].g-100),ee=!1;else try{ig(Ee,D,"req"+Y+"_")}catch{f&&f(Ee)}}if(ee){f=D.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function fh(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;vr||El(),Ir||(vr(),Ir=!0),Eo.add(c,s),s.v=0}}function $o(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Sr(S(s.Fa,s),gh(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,ph(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Sr(S(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xe(10),Li(this),ph(this))};function Go(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function ph(s){s.g=new St(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=ut(s.qa);re(c,"RID","rpc"),re(c,"SID",s.K),re(c,"AID",s.T),re(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&re(c,"TO",s.ja),re(c,"TYPE","xmlhttp"),Mr(s,c),s.m&&s.o&&jo(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=Oi(ut(c)),l.m=null,l.P=!0,Bl(l,s)}n.Za=function(){this.C!=null&&(this.C=null,Li(this),$o(this),xe(19))};function Ui(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function mh(s,c){var l=null;if(s.g==c){Ui(s),Go(s),s.g=null;var f=2}else if(qo(s.h,c))l=c.D,Kl(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var T=s.B;f=Pi(),De(f,new Ll(f,l)),Fi(s)}else fh(s);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&cg(s,c)||f==2&&$o(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),T){case 1:Yt(s,5);break;case 4:Yt(s,10);break;case 3:Yt(s,6);break;default:Yt(s,2)}}}function gh(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function Yt(s,c){if(s.j.info("Error code "+c),c==2){var l=S(s.fb,s),f=s.Xa;let T=!f;f=new Jt(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||xi(f,"https"),Oi(f),T?tg(f.toString(),l):ng(f.toString(),l)}else xe(2);s.G=0,s.l&&s.l.sa(c),_h(s),lh(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),xe(2)):(this.j.info("Failed to ping google.com"),xe(1))};function _h(s){if(s.G=0,s.ka=[],s.l){let c=Hl(s.h);(c.length!=0||s.i.length!=0)&&(x(s.ka,c),x(s.ka,s.i),s.h.i.length=0,F(s.i),s.i.length=0),s.l.ra()}}function yh(s,c,l){var f=l instanceof Jt?ut(l):new Jt(l);if(f.g!="")c&&(f.g=c+"."+f.g),Ni(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var A=new Jt(null);f&&xi(A,f),c&&(A.g=c),T&&Ni(A,T),l&&(A.l=l),f=A}return l=s.D,c=s.ya,l&&c&&re(f,l,c),re(f,"VER",s.la),Mr(s,f),f}function vh(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new ae(new xr({eb:l})):new ae(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ih(){}n=Ih.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function qi(){}qi.prototype.g=function(s,c){return new Ve(s,c)};function Ve(s,c){we.call(this),this.g=new uh(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!K(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!K(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new Sn(this)}O(Ve,we),Ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ve.prototype.close=function(){zo(this.g)},Ve.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=Do(s),s=l);c.i.push(new Gm(c.Ya++,s)),c.G==3&&Fi(c)},Ve.prototype.N=function(){this.g.l=null,delete this.j,zo(this.g),delete this.g,Ve.aa.N.call(this)};function wh(s){No.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}O(wh,No);function Eh(){Oo.call(this),this.status=1}O(Eh,Oo);function Sn(s){this.g=s}O(Sn,Ih),Sn.prototype.ua=function(){De(this.g,"a")},Sn.prototype.ta=function(s){De(this.g,new wh(s))},Sn.prototype.sa=function(s){De(this.g,new Eh)},Sn.prototype.ra=function(){De(this.g,"b")},qi.prototype.createWebChannel=qi.prototype.g,Ve.prototype.send=Ve.prototype.o,Ve.prototype.open=Ve.prototype.m,Ve.prototype.close=Ve.prototype.close,pc=yt.createWebChannelTransport=function(){return new qi},fc=yt.getStatEventTarget=function(){return Pi()},dc=yt.Event=Ht,Is=yt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ri.NO_ERROR=0,Ri.TIMEOUT=8,Ri.HTTP_ERROR=6,ti=yt.ErrorCode=Ri,Fl.COMPLETE="complete",hc=yt.EventType=Fl,Nl.EventType=br,br.OPEN="a",br.CLOSE="b",br.ERROR="c",br.MESSAGE="d",we.prototype.listen=we.prototype.K,Qn=yt.WebChannel=Nl,lc=yt.FetchXmlHttpFactory=xr,ae.prototype.listenOnce=ae.prototype.L,ae.prototype.getLastError=ae.prototype.Ka,ae.prototype.getLastErrorCode=ae.prototype.Ba,ae.prototype.getStatus=ae.prototype.Z,ae.prototype.getResponseJson=ae.prototype.Oa,ae.prototype.getResponseText=ae.prototype.oa,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Ha,uc=yt.XhrIo=ae}).apply(typeof vs<"u"?vs:typeof self<"u"?self:typeof window<"u"?window:{});var Af="@firebase/firestore";var ye=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};ye.UNAUTHENTICATED=new ye(null),ye.GOOGLE_CREDENTIALS=new ye("google-credentials-uid"),ye.FIRST_PARTY=new ye("first-party-uid"),ye.MOCK_USER=new ye("mock-user");var pr="10.13.1";var mn=new Ot("@firebase/firestore");function ni(){return mn.logLevel}function L(n,...e){if(mn.logLevel<=G.DEBUG){let t=e.map(tl);mn.debug(`Firestore (${pr}): ${n}`,...t)}}function It(n,...e){if(mn.logLevel<=G.ERROR){let t=e.map(tl);mn.error(`Firestore (${pr}): ${n}`,...t)}}function nr(n,...e){if(mn.logLevel<=G.WARN){let t=e.map(tl);mn.warn(`Firestore (${pr}): ${n}`,...t)}}function tl(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function B(n="Unexpected state"){let e=`FIRESTORE (${pr}) INTERNAL ASSERTION FAILED: `+n;throw It(e),new Error(e)}function te(n,e){n||B()}function j(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Me{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var vt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var As=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},vc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ye.UNAUTHENTICATED))}shutdown(){}},Ic=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},wc=class{constructor(e){this.t=e,this.currentUser=ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new vt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new vt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new vt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string"),new As(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string"),new ye(e)}},Ec=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ye.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Tc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Ec(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}},bc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Ac=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,L("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te(typeof t.token=="string"),this.R=t.token,new bc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function mv(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Ss=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=mv(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function X(n,e){return n<e?-1:n>e?1:0}function rr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ge=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var z=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ge(0,0))}static max(){return new n(new ge(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Cs=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(),r===void 0?r=e.length-t:r>e.length-t&&B(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},oe=class n extends Cs{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},gv=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Fe=class n extends Cs{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return gv.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new M(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new M(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new M(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new M(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var U=class n{constructor(e){this.path=e}static fromPath(e){return new n(oe.fromString(e))}static fromName(e){return new n(oe.fromString(e).popFirst(5))}static empty(){return new n(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new oe(e.slice()))}};var Sc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Sc.UNKNOWN_ID=-1;function _v(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=z.fromTimestamp(r===1e9?new ge(t+1,0):new ge(t,r));return new gn(i,U.empty(),e)}function yv(n){return new gn(n.readTime,n.key,-1)}var gn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(z.min(),U.empty(),-1)}static max(){return new n(z.max(),U.empty(),-1)}};function vv(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=U.comparator(n.documentKey,e.documentKey),t!==0?t:X(n.largestBatchId,e.largestBatchId))}var Iv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Cc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function wi(n){return y(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==Iv)throw n;L("LocalStore","Unexpectedly lost primary lease")})}var k=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function wv(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ei(n){return n.name==="IndexedDbTransactionError"}var op=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function no(n){return n==null}function ui(n){return n===0&&1/n==-1/0}function Ev(n){return typeof n=="number"&&Number.isInteger(n)&&!ui(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Tv=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ST=[...Tv,"documentOverlays"],bv=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Av=bv,Sv=[...Av,"indexConfiguration","indexState","indexEntries"];var CT=[...Sv,"globals"];function Sf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function mr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ap(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var le=class n{constructor(e,t){this.comparator=e,this.root=t||it.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,it.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,it.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zn(this.root,e,this.comparator,!0)}},Zn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},it=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();let e=this.left.check();if(e!==this.right.check())throw B();return e+(this.isRed()?0:1)}};it.EMPTY=null,it.RED=!0,it.BLACK=!1;it.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(e,t,r,i,o){return this}insert(e,t,r){return new it(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Pe=class n{constructor(e){this.comparator=e,this.data=new le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ps(this.data.getIterator())}getIteratorFrom(e){return new Ps(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Ps=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var rt=class n{constructor(e){this.fields=e,e.sort(Fe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Pe(Fe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Rs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Re=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Rs("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Re.EMPTY_BYTE_STRING=new Re("");var Cv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wt(n){if(te(!!n),typeof n=="string"){let e=0,t=Cv.exec(n);if(te(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:se(n.seconds),nanos:se(n.nanos)}}function se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function $t(n){return typeof n=="string"?Re.fromBase64String(n):Re.fromUint8Array(n)}function nl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function rl(n){let e=n.mapValue.fields.__previous_value__;return nl(e)?rl(e):e}function li(n){let e=wt(n.mapValue.fields.__local_write_time__.timestampValue);return new ge(e.seconds,e.nanos)}var Pc=class{constructor(e,t,r,i,o,a,u,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d}},ks=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ws={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function _n(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?nl(n)?4:up(n)?9007199254740991:cp(n)?10:11:B()}function at(n,e){if(n===e)return!0;let t=_n(n);if(t!==_n(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return li(n).isEqual(li(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=wt(i.timestampValue),u=wt(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return $t(i.bytesValue).isEqual($t(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return se(i.geoPointValue.latitude)===se(o.geoPointValue.latitude)&&se(i.geoPointValue.longitude)===se(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return se(i.integerValue)===se(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=se(i.doubleValue),u=se(o.doubleValue);return a===u?ui(a)===ui(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return rr(n.arrayValue.values||[],e.arrayValue.values||[],at);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Sf(a)!==Sf(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!at(a[h],u[h])))return!1;return!0}(n,e);default:return B()}}function hi(n,e){return(n.values||[]).find(t=>at(t,e))!==void 0}function ir(n,e){if(n===e)return 0;let t=_n(n),r=_n(e);if(t!==r)return X(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return X(n.booleanValue,e.booleanValue);case 2:return function(o,a){let u=se(o.integerValue||o.doubleValue),h=se(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(n,e);case 3:return Cf(n.timestampValue,e.timestampValue);case 4:return Cf(li(n),li(e));case 5:return X(n.stringValue,e.stringValue);case 6:return function(o,a){let u=$t(o),h=$t(a);return u.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=X(u[d],h[d]);if(p!==0)return p}return X(u.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let u=X(se(o.latitude),se(a.latitude));return u!==0?u:X(se(o.longitude),se(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Pf(n.arrayValue,e.arrayValue);case 10:return function(o,a){var u,h,d,p;let I=o.fields||{},S=a.fields||{},P=(u=I.value)===null||u===void 0?void 0:u.arrayValue,O=(h=S.value)===null||h===void 0?void 0:h.arrayValue,F=X(((d=P?.values)===null||d===void 0?void 0:d.length)||0,((p=O?.values)===null||p===void 0?void 0:p.length)||0);return F!==0?F:Pf(P,O)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===ws.mapValue&&a===ws.mapValue)return 0;if(o===ws.mapValue)return 1;if(a===ws.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let I=0;I<h.length&&I<p.length;++I){let S=X(h[I],p[I]);if(S!==0)return S;let P=ir(u[h[I]],d[p[I]]);if(P!==0)return P}return X(h.length,p.length)}(n.mapValue,e.mapValue);default:throw B()}}function Cf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return X(n,e);let t=wt(n),r=wt(e),i=X(t.seconds,r.seconds);return i!==0?i:X(t.nanos,r.nanos)}function Pf(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=ir(t[i],r[i]);if(o)return o}return X(t.length,r.length)}function sr(n){return Rc(n)}function Rc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=wt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return $t(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return U.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=Rc(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${Rc(t.fields[a])}`;return i+"}"}(n.mapValue):B()}function Rf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function kc(n){return!!n&&"integerValue"in n}function il(n){return!!n&&"arrayValue"in n}function kf(n){return!!n&&"nullValue"in n}function Df(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ts(n){return!!n&&"mapValue"in n}function cp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ii(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return mr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ii(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ii(n.arrayValue.values[t]);return e}return Object.assign({},n)}function up(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Qe=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Ts(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ii(t)}setAll(e){let t=Fe.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=ii(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Ts(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return at(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Ts(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){mr(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ii(this.value))}};function lp(n){let e=[];return mr(n.fields,(t,r)=>{let i=new Fe([t]);if(Ts(r)){let o=lp(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new rt(e)}var Je=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,z.min(),z.min(),z.min(),Qe.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,z.min(),z.min(),Qe.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,z.min(),z.min(),Qe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var or=class{constructor(e,t){this.position=e,this.inclusive=t}};function xf(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=U.comparator(U.fromName(a.referenceValue),t.key):r=ir(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Nf(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!at(n.position[t],e.position[t]))return!1;return!0}var yn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Pv(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ds=class{},pe=class n extends Ds{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new xc(e,t,r):t==="array-contains"?new Vc(e,r):t==="in"?new Mc(e,r):t==="not-in"?new Lc(e,r):t==="array-contains-any"?new Fc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Nc(e,r):new Oc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ir(t,this.value)):t!==null&&_n(this.value)===_n(t)&&this.matchesComparison(ir(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ye=class n extends Ds{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return hp(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function hp(n){return n.op==="and"}function dp(n){return Rv(n)&&hp(n)}function Rv(n){for(let e of n.filters)if(e instanceof Ye)return!1;return!0}function Dc(n){if(n instanceof pe)return n.field.canonicalString()+n.op.toString()+sr(n.value);if(dp(n))return n.filters.map(e=>Dc(e)).join(",");{let e=n.filters.map(t=>Dc(t)).join(",");return`${n.op}(${e})`}}function fp(n,e){return n instanceof pe?function(r,i){return i instanceof pe&&r.op===i.op&&r.field.isEqual(i.field)&&at(r.value,i.value)}(n,e):n instanceof Ye?function(r,i){return i instanceof Ye&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&fp(a,i.filters[u]),!0):!1}(n,e):void B()}function pp(n){return n instanceof pe?function(t){return`${t.field.canonicalString()} ${t.op} ${sr(t.value)}`}(n):n instanceof Ye?function(t){return t.op.toString()+" {"+t.getFilters().map(pp).join(" ,")+"}"}(n):"Filter"}var xc=class extends pe{constructor(e,t,r){super(e,t,r),this.key=U.fromName(r.referenceValue)}matches(e){let t=U.comparator(e.key,this.key);return this.matchesComparison(t)}},Nc=class extends pe{constructor(e,t){super(e,"in",t),this.keys=mp("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Oc=class extends pe{constructor(e,t){super(e,"not-in",t),this.keys=mp("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function mp(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>U.fromName(r.referenceValue))}var Vc=class extends pe{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return il(t)&&hi(t.arrayValue,this.value)}},Mc=class extends pe{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&hi(this.value.arrayValue,t)}},Lc=class extends pe{constructor(e,t){super(e,"not-in",t)}matches(e){if(hi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!hi(this.value.arrayValue,t)}},Fc=class extends pe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!il(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>hi(this.value.arrayValue,r))}};var Uc=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.ue=null}};function Of(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Uc(n,e,t,r,i,o,a)}function sl(n){let e=j(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Dc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),no(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>sr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>sr(r)).join(",")),e.ue=t}return e.ue}function ol(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Pv(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!fp(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Nf(n.startAt,e.startAt)&&Nf(n.endAt,e.endAt)}function qc(n){return U.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Gt=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function kv(n,e,t,r,i,o,a,u){return new Gt(n,e,t,r,i,o,a,u)}function al(n){return new Gt(n)}function Vf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function gp(n){return n.collectionGroup!==null}function si(n){let e=j(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Pe(Fe.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new yn(o,r))}),t.has(Fe.keyField().canonicalString())||e.ce.push(new yn(Fe.keyField(),r))}return e.ce}function st(n){let e=j(n);return e.le||(e.le=Dv(e,si(n))),e.le}function Dv(n,e){if(n.limitType==="F")return Of(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new yn(i.field,o)});let t=n.endAt?new or(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new or(n.startAt.position,n.startAt.inclusive):null;return Of(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Bc(n,e){let t=n.filters.concat([e]);return new Gt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function jc(n,e,t){return new Gt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ro(n,e){return ol(st(n),st(e))&&n.limitType===e.limitType}function _p(n){return`${sl(st(n))}|lt:${n.limitType}`}function Jn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>pp(i)).join(", ")}]`),no(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>sr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>sr(i)).join(",")),`Target(${r})`}(st(n))}; limitType=${n.limitType})`}function io(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):U.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of si(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,h){let d=xf(a,u,h);return a.inclusive?d<=0:d<0}(r.startAt,si(r),i)||r.endAt&&!function(a,u,h){let d=xf(a,u,h);return a.inclusive?d>=0:d>0}(r.endAt,si(r),i))}(n,e)}function xv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function yp(n){return(e,t)=>{let r=!1;for(let i of si(n)){let o=Nv(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Nv(n,e,t){let r=n.field.isKeyField()?U.comparator(e.key,t.key):function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?ir(h,d):B()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B()}}var Wt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){mr(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return ap(this.inner)}size(){return this.innerSize}};var Ov=new le(U.comparator);function Et(){return Ov}var vp=new le(U.comparator);function ri(...n){let e=vp;for(let t of n)e=e.insert(t.key,t);return e}function Ip(n){let e=vp;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function hn(){return oi()}function wp(){return oi()}function oi(){return new Wt(n=>n.toString(),(n,e)=>n.isEqual(e))}var Vv=new le(U.comparator),Mv=new Pe(U.comparator);function W(...n){let e=Mv;for(let t of n)e=e.add(t);return e}var Lv=new Pe(X);function Fv(){return Lv}function cl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ui(e)?"-0":e}}function Ep(n){return{integerValue:""+n}}function Uv(n,e){return Ev(e)?Ep(e):cl(n,e)}var ar=class{constructor(){this._=void 0}};function qv(n,e,t){return n instanceof cr?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&nl(o)&&(o=rl(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof vn?bp(n,e):n instanceof In?Ap(n,e):function(i,o){let a=Tp(i,o),u=Mf(a)+Mf(i.Pe);return kc(a)&&kc(i.Pe)?Ep(u):cl(i.serializer,u)}(n,e)}function Bv(n,e,t){return n instanceof vn?bp(n,e):n instanceof In?Ap(n,e):t}function Tp(n,e){return n instanceof ur?function(r){return kc(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var cr=class extends ar{},vn=class extends ar{constructor(e){super(),this.elements=e}};function bp(n,e){let t=Sp(e);for(let r of n.elements)t.some(i=>at(i,r))||t.push(r);return{arrayValue:{values:t}}}var In=class extends ar{constructor(e){super(),this.elements=e}};function Ap(n,e){let t=Sp(e);for(let r of n.elements)t=t.filter(i=>!at(i,r));return{arrayValue:{values:t}}}var ur=class extends ar{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Mf(n){return se(n.integerValue||n.doubleValue)}function Sp(n){return il(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function jv(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof vn&&i instanceof vn||r instanceof In&&i instanceof In?rr(r.elements,i.elements,at):r instanceof ur&&i instanceof ur?at(r.Pe,i.Pe):r instanceof cr&&i instanceof cr}(n.transform,e.transform)}var zc=class{constructor(e,t){this.version=e,this.transformResults=t}},pn=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function bs(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var lr=class{};function Cp(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new xs(n.key,pn.none()):new wn(n.key,n.data,pn.none());{let t=n.data,r=Qe.empty(),i=new Pe(Fe.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new Tt(n.key,r,new rt(i.toArray()),pn.none())}}function zv(n,e,t){n instanceof wn?function(i,o,a){let u=i.value.clone(),h=Ff(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Tt?function(i,o,a){if(!bs(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=Ff(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Pp(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function ai(n,e,t,r){return n instanceof wn?function(o,a,u,h){if(!bs(o.precondition,a))return u;let d=o.value.clone(),p=Uf(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Tt?function(o,a,u,h){if(!bs(o.precondition,a))return u;let d=Uf(o.fieldTransforms,h,a),p=a.data;return p.setAll(Pp(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(I=>I.field))}(n,e,t,r):function(o,a,u){return bs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function $v(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=Tp(r.transform,i||null);o!=null&&(t===null&&(t=Qe.empty()),t.set(r.field,o))}return t||null}function Lf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&rr(r,i,(o,a)=>jv(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var wn=class extends lr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Tt=class extends lr{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Pp(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Ff(n,e,t){let r=new Map;te(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,Bv(a,u,t[i]))}return r}function Uf(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,qv(o,a,e))}return r}var xs=class extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},$c=class extends lr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Gc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&zv(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ai(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ai(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=wp();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=Cp(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),W())}isEqual(e){return this.batchId===e.batchId&&rr(this.mutations,e.mutations,(t,r)=>Lf(t,r))&&rr(this.baseMutations,e.baseMutations,(t,r)=>Lf(t,r))}},Wc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){te(e.mutations.length===r.length);let i=function(){return Vv}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Kc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Hc=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var de,Q;function Gv(n){switch(n){default:return B();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function Rp(n){if(n===void 0)return It("GRPC error has no .code"),C.UNKNOWN;switch(n){case de.OK:return C.OK;case de.CANCELLED:return C.CANCELLED;case de.UNKNOWN:return C.UNKNOWN;case de.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case de.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case de.INTERNAL:return C.INTERNAL;case de.UNAVAILABLE:return C.UNAVAILABLE;case de.UNAUTHENTICATED:return C.UNAUTHENTICATED;case de.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case de.NOT_FOUND:return C.NOT_FOUND;case de.ALREADY_EXISTS:return C.ALREADY_EXISTS;case de.PERMISSION_DENIED:return C.PERMISSION_DENIED;case de.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case de.ABORTED:return C.ABORTED;case de.OUT_OF_RANGE:return C.OUT_OF_RANGE;case de.UNIMPLEMENTED:return C.UNIMPLEMENTED;case de.DATA_LOSS:return C.DATA_LOSS;default:return B()}}(Q=de||(de={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";var qf=null;function Wv(){return new TextEncoder}var Kv=new jt([4294967295,4294967295],0);function Bf(n){let e=Wv().encode(n),t=new cc;return t.update(e),new Uint8Array(t.digest())}function jf(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new jt([t,r],0),new jt([i,o],0)]}var Qc=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new dn(`Invalid padding: ${t}`);if(r<0)throw new dn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new dn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new dn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=jt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(jt.fromNumber(r)));return i.compare(Kv)===1&&(i=new jt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Bf(e),[r,i]=jf(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Bf(e),[r,i]=jf(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},dn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ns=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,di.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(z.min(),i,new le(X),Et(),W())}},di=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,W(),W(),W())}};var er=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Os=class{constructor(e,t){this.targetId=e,this.me=t}},Vs=class{constructor(e,t,r=Re.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ms=class{constructor(){this.fe=0,this.ge=$f(),this.pe=Re.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=W(),t=W(),r=W();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:B()}}),new di(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=$f()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Jc=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Et(),this.qe=zf(),this.Qe=new le(X)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:B()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(qc(o))if(r===0){let a=new U(o.path);this.Ue(t,a,Je.newNoDocument(a,z.min()))}else te(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),h=u?this.Xe(u,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}qf?.et(function(p,I,S,P,O){var F,x,$,K,H,ne;let ke={localCacheCount:p,existenceFilterCount:I.count,databaseId:S.database,projectId:S.projectId},Z=I.unchangedNames;return Z&&(ke.bloomFilter={applied:O===0,hashCount:(F=Z?.hashCount)!==null&&F!==void 0?F:0,bitmapLength:(K=($=(x=Z?.bits)===null||x===void 0?void 0:x.bitmap)===null||$===void 0?void 0:$.length)!==null&&K!==void 0?K:0,padding:(ne=(H=Z?.bits)===null||H===void 0?void 0:H.padding)!==null&&ne!==void 0?ne:0,mightContain:w=>{var m;return(m=P?.mightContain(w))!==null&&m!==void 0&&m}}),ke}(a,e.me,this.Le.tt(),u,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=$t(r).toUint8Array()}catch(h){if(h instanceof Rs)return nr("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Qc(a,i,o)}catch(h){return nr(h instanceof dn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,a)=>{let u=this.Je(a);if(u){if(o.current&&qc(u.target)){let h=new U(u.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,Je.newNoDocument(h,e))}o.be&&(t.set(a,o.ve()),o.Ce())}});let r=W();this.qe.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));let i=new Ns(e,t,this.Qe,this.ke,r);return this.ke=Et(),this.qe=zf(),this.Qe=new le(X),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ms,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Pe(X),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||L("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ms),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function zf(){return new le(U.comparator)}function $f(){return new le(U.comparator)}var Hv={asc:"ASCENDING",desc:"DESCENDING"},Qv={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jv={and:"AND",or:"OR"},Yc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Xc(n,e){return n.useProto3Json||no(e)?e:{value:e}}function Ls(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kp(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Yv(n,e){return Ls(n,e.toTimestamp())}function ot(n){return te(!!n),z.fromTimestamp(function(t){let r=wt(t);return new ge(r.seconds,r.nanos)}(n))}function ul(n,e){return Zc(n,e).canonicalString()}function Zc(n,e){let t=function(i){return new oe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Dp(n){let e=oe.fromString(n);return te(Mp(e)),e}function eu(n,e){return ul(n.databaseId,e.path)}function mc(n,e){let t=Dp(e);if(t.get(1)!==n.databaseId.projectId)throw new M(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new U(Np(t))}function xp(n,e){return ul(n.databaseId,e)}function Xv(n){let e=Dp(n);return e.length===4?oe.emptyPath():Np(e)}function tu(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Np(n){return te(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Gf(n,e,t){return{name:eu(n,e),fields:t.value.mapValue.fields}}function Zv(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:B()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(te(p===void 0||typeof p=="string"),Re.fromBase64String(p||"")):(te(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Re.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?C.UNKNOWN:Rp(d.code);return new M(p,d.message||"")}(a);t=new Vs(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=mc(n,r.document.name),o=ot(r.document.updateTime),a=r.document.createTime?ot(r.document.createTime):z.min(),u=new Qe({mapValue:{fields:r.document.fields}}),h=Je.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new er(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=mc(n,r.document),o=r.readTime?ot(r.readTime):z.min(),a=Je.newNoDocument(i,o),u=r.removedTargetIds||[];t=new er([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=mc(n,r.document),o=r.removedTargetIds||[];t=new er([],o,i,null)}else{if(!("filter"in e))return B();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new Hc(i,o),u=r.targetId;t=new Os(u,a)}}return t}function eI(n,e){let t;if(e instanceof wn)t={update:Gf(n,e.key,e.value)};else if(e instanceof xs)t={delete:eu(n,e.key)};else if(e instanceof Tt)t={update:Gf(n,e.key,e.data),updateMask:uI(e.fieldMask)};else{if(!(e instanceof $c))return B();t={verify:eu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let u=a.transform;if(u instanceof cr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof vn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof In)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof ur)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw B()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:Yv(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:B()}(n,e.precondition)),t}function tI(n,e){return n&&n.length>0?(te(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?ot(i.updateTime):ot(o);return a.isEqual(z.min())&&(a=ot(o)),new zc(a,i.transformResults||[])}(t,e))):[]}function nI(n,e){return{documents:[xp(n,e.path)]}}function rI(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=xp(n,i);let o=function(d){if(d.length!==0)return Vp(Ye.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(S){return{field:Yn(S.field),direction:oI(S.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Xc(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function iI(n){let e=Xv(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){te(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(I){let S=Op(I);return S instanceof Ye&&dp(S)?S.getFilters():[S]}(t.where));let a=[];t.orderBy&&(a=function(I){return I.map(S=>function(O){return new yn(Xn(O.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(O.direction))}(S))}(t.orderBy));let u=null;t.limit&&(u=function(I){let S;return S=typeof I=="object"?I.value:I,no(S)?null:S}(t.limit));let h=null;t.startAt&&(h=function(I){let S=!!I.before,P=I.values||[];return new or(P,S)}(t.startAt));let d=null;return t.endAt&&(d=function(I){let S=!I.before,P=I.values||[];return new or(P,S)}(t.endAt)),kv(e,i,a,o,u,"F",h,d)}function sI(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return B()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Op(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Xn(t.unaryFilter.field);return pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Xn(t.unaryFilter.field);return pe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Xn(t.unaryFilter.field);return pe.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Xn(t.unaryFilter.field);return pe.create(a,"!=",{nullValue:"NULL_VALUE"});default:return B()}}(n):n.fieldFilter!==void 0?function(t){return pe.create(Xn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return B()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ye.create(t.compositeFilter.filters.map(r=>Op(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B()}}(t.compositeFilter.op))}(n):B()}function oI(n){return Hv[n]}function aI(n){return Qv[n]}function cI(n){return Jv[n]}function Yn(n){return{fieldPath:n.canonicalString()}}function Xn(n){return Fe.fromServerFormat(n.fieldPath)}function Vp(n){return n instanceof pe?function(t){if(t.op==="=="){if(Df(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NAN"}};if(kf(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Df(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NOT_NAN"}};if(kf(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yn(t.field),op:aI(t.op),value:t.value}}}(n):n instanceof Ye?function(t){let r=t.getFilters().map(i=>Vp(i));return r.length===1?r[0]:{compositeFilter:{op:cI(t.op),filters:r}}}(n):B()}function uI(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Mp(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var fi=class n{constructor(e,t,r,i,o=z.min(),a=z.min(),u=Re.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var nu=class{constructor(e){this.ct=e}};function lI(n){let e=iI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jc(e,e.limit,"L"):e}var Fs=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(se(e.integerValue));else if("doubleValue"in e){let r=se(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),ui(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=wt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt($t(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?up(e)?this.dt(t,Number.MAX_SAFE_INTEGER):cp(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):B()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(se(u)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),U.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Fs.vt=new Fs;var ru=class{constructor(){this.un=new iu}addToCollectionParentIndex(e,t){return this.un.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(gn.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(gn.min())}updateCollectionGroup(e,t,r){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},iu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Pe(oe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Pe(oe.comparator)).toArray()}};var RT=new Uint8Array(0);var nt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};nt.DEFAULT_COLLECTION_PERCENTILE=10,nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nt.DEFAULT=new nt(41943040,nt.DEFAULT_COLLECTION_PERCENTILE,nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nt.DISABLED=new nt(-1,0,0);var pi=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var su=class{constructor(){this.changes=new Wt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Je.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?k.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ou=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var au=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ai(r.mutation,i,rt.empty(),ge.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,W()).next(()=>r))}getLocalViewOfDocuments(e,t,r=W()){let i=hn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=ri();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=hn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,W()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=Et(),a=oi(),u=function(){return oi()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Tt)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),ai(p.mutation,d,p.mutation.getFieldMask(),ge.now())):a.set(d.key,rt.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var I;return u.set(d,new ou(p,(I=a.get(d))!==null&&I!==void 0?I:null))}),u))}recalculateAndSaveOverlays(e,t){let r=oi(),i=new le((a,u)=>a-u),o=W();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||rt.empty();p=u.applyToLocalView(d,p),r.set(h,p);let I=(i.get(u.batchId)||W()).add(h);i=i.insert(u.batchId,I)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,I=wp();p.forEach(S=>{if(!o.has(S)){let P=Cp(t.get(S),r.get(S));P!==null&&I.set(S,P),o=o.add(S)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,I))}return k.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return U.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):k.resolve(hn()),u=-1,h=o;return a.next(d=>k.forEach(d,(p,I)=>(u<I.largestBatchId&&(u=I.largestBatchId),o.get(p)?k.resolve():this.remoteDocumentCache.getEntry(e,p).next(S=>{h=h.insert(p,S)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,W())).next(p=>({batchId:u,changes:Ip(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new U(t)).next(r=>{let i=ri();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=ri();return this.indexManager.getCollectionParents(e,o).next(u=>k.forEach(u,h=>{let d=function(I,S){return new Gt(S,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((I,S)=>{a=a.insert(I,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,Je.newInvalidDocument(p)))});let u=ri();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&ai(p.mutation,d,rt.empty(),ge.now()),io(t,d)&&(u=u.insert(h,d))}),u})}};var cu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return k.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ot(i.createTime)}}(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:lI(i.bundledQuery),readTime:ot(i.readTime)}}(t)),k.resolve()}};var uu=class{constructor(){this.overlays=new le(U.comparator),this.Ir=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let r=hn();return k.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),k.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),k.resolve()}getOverlaysForCollection(e,t,r){let i=hn(),o=t.length+1,a=new U(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return k.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new le((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=hn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=hn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return k.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Kc(t,r));let o=this.Ir.get(t);o===void 0&&(o=W(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var lu=class{constructor(){this.sessionToken=Re.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}};var mi=class{constructor(){this.Tr=new Pe(fe.Er),this.dr=new Pe(fe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new fe(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new fe(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new U(new oe([])),r=new fe(t,e),i=new fe(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new U(new oe([])),r=new fe(t,e),i=new fe(t,e+1),o=W();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new fe(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},fe=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return U.comparator(e.key,t.key)||X(e.wr,t.wr)}static Ar(e,t){return X(e.wr,t.wr)||U.comparator(e.key,t.key)}};var hu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Pe(fe.Er)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Gc(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new fe(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return k.resolve(a)}lookupMutationBatch(e,t){return k.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return k.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new fe(t,0),i=new fe(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);o.push(u)}),k.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pe(X);return t.forEach(i=>{let o=new fe(i,0),a=new fe(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],u=>{r=r.add(u.wr)})}),k.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;U.isDocumentKey(o)||(o=o.child(""));let a=new fe(new U(o),0),u=new Pe(X);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.wr)),!0)},a),k.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){te(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return k.forEach(t.mutations,i=>{let o=new fe(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new fe(t,0),i=this.br.firstAfterOrEqual(r);return k.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var du=class{constructor(e){this.Mr=e,this.docs=function(){return new le(U.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return k.resolve(r?r.document.mutableCopy():Je.newInvalidDocument(t))}getEntries(e,t){let r=Et();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Je.newInvalidDocument(i))}),k.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Et(),a=t.path,u=new U(a.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||vv(yv(p),r)<=0||(i.has(p.key)||io(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return k.resolve(o)}getAllFromCollectionGroup(e,t,r,i){B()}Or(e,t){return k.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new fu(this)}getSize(e){return k.resolve(this.size)}},fu=class extends su{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),k.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var pu=class{constructor(e){this.persistence=e,this.Nr=new Wt(t=>sl(t),ol),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.Lr=0,this.Br=new mi,this.targetCount=0,this.kr=pi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),k.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new pi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Kn(t),k.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),k.waitFor(o).next(()=>i)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return k.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),k.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),k.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),k.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return k.resolve(r)}containsKey(e,t){return k.resolve(this.Br.containsKey(t))}};var mu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new op(0),this.Kr=!1,this.Kr=!0,this.$r=new lu,this.referenceDelegate=e(this),this.Ur=new pu(this),this.indexManager=new ru,this.remoteDocumentCache=function(i){return new du(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new nu(t),this.Gr=new cu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new hu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){L("MemoryPersistence","Starting transaction:",e);let i=new gu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return k.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},gu=class extends Cc{constructor(e){super(),this.currentSequenceNumber=e}},_u=class n{constructor(e){this.persistence=e,this.Jr=new mi,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw B()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),k.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),k.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.Xr,r=>{let i=U.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,z.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return k.or([()=>k.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var yu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=W(),i=W();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var vu=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Iu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return rd()?8:wv(_e())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new vu;return this.Xi(e,t,a).next(u=>{if(o.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(ni()<=G.DEBUG&&L("QueryEngine","SDK will not create cache indexes for query:",Jn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),k.resolve()):(ni()<=G.DEBUG&&L("QueryEngine","Query:",Jn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ni()<=G.DEBUG&&L("QueryEngine","The SDK decides to create cache indexes for query:",Jn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,st(t))):k.resolve())}Yi(e,t){if(Vf(t))return k.resolve(null);let r=st(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=jc(t,null,"F"),r=st(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=W(...o);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,u);return this.ns(t,d,a,h.readTime)?this.Yi(e,jc(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return Vf(t)||i.isEqual(z.min())?k.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?k.resolve(null):(ni()<=G.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jn(t)),this.rs(e,a,t,_v(i,-1)).next(u=>u))})}ts(e,t){let r=new Pe(yp(e));return t.forEach((i,o)=>{io(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return ni()<=G.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",Jn(t)),this.Ji.getDocumentsMatchingQuery(e,t,gn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var wu=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new le(X),this._s=new Wt(o=>sl(o),ol),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new au(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function hI(n,e,t,r){return new wu(n,e,t,r)}function Lp(n,e){return y(this,null,function*(){let t=j(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=W();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function dI(n,e){let t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,h,d,p){let I=d.batch,S=I.keys(),P=k.resolve();return S.forEach(O=>{P=P.next(()=>p.getEntry(h,O)).next(F=>{let x=d.docVersions.get(O);te(x!==null),F.version.compareTo(x)<0&&(I.applyToRemoteDocument(F,d),F.isValidDocument()&&(F.setReadTime(d.commitVersion),p.addEntry(F)))})}),P.next(()=>u.mutationQueue.removeMutationBatch(h,I))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let h=W();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Fp(n){let e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function fI(n,e){let t=j(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,I)=>{let S=i.get(I);if(!S)return;u.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,I).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,I)));let P=S.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(I)!==null?P=P.withResumeToken(Re.EMPTY_BYTE_STRING,z.min()).withLastLimboFreeSnapshotVersion(z.min()):p.resumeToken.approximateByteSize()>0&&(P=P.withResumeToken(p.resumeToken,r)),i=i.insert(I,P),function(F,x,$){return F.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=3e8?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(S,P,p)&&u.push(t.Ur.updateTargetData(o,P))});let h=Et(),d=W();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(pI(o,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual(z.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(I=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return k.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.os=i,o))}function pI(n,e,t){let r=W(),i=W();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=Et();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(z.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):L("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function mI(n,e){let t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gI(n,e){let t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,k.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new fi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Eu(n,e,t){return y(this,null,function*(){let r=j(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Ei(a))throw a;L("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Wf(n,e,t){let r=j(n),i=z.min(),o=W();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let I=j(h),S=I._s.get(p);return S!==void 0?k.resolve(I.os.get(S)):I.Ur.getTargetData(d,p)}(r,a,st(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:z.min(),t?o:W())).next(u=>(_I(r,xv(e),u),{documents:u,Ts:o})))}function _I(n,e,t){let r=n.us.get(e)||z.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var Us=class{constructor(){this.activeTargetIds=Fv()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Tu=class{constructor(){this.so=new Us,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Us,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var bu=class{_o(e){}shutdown(){}};var qs=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Es=null;function gc(){return Es===null?Es=function(){return 268435456+Math.round(2147483648*Math.random())}():Es++,"0x"+Es.toString(16)}var yI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Au=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ce="WebChannelConnection",Su=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let u=gc(),h=this.xo(t,r.toUriEncodedString());L("RestConnection",`Sending RPC '${t}' ${u}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,a),this.No(t,h,d,i).then(p=>(L("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw nr("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,a,u){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=yI[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=gc();return new Promise((a,u)=>{let h=new uc;h.setWithCredentials(!0),h.listenOnce(hc.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ti.NO_ERROR:let p=h.getResponseJson();L(Ce,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case ti.TIMEOUT:L(Ce,`RPC '${e}' ${o} timed out`),u(new M(C.DEADLINE_EXCEEDED,"Request time out"));break;case ti.HTTP_ERROR:let I=h.getStatus();if(L(Ce,`RPC '${e}' ${o} failed with status:`,I,"response text:",h.getResponseText()),I>0){let S=h.getResponseJson();Array.isArray(S)&&(S=S[0]);let P=S?.error;if(P&&P.status&&P.message){let O=function(x){let $=x.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf($)>=0?$:C.UNKNOWN}(P.status);u(new M(O,P.message))}else u(new M(C.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new M(C.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{L(Ce,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);L(Ce,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=gc(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=pc(),u=fc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.xmlHttpFactory=new lc({})),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");L(Ce,`Creating RPC '${e}' stream ${i}: ${p}`,h);let I=a.createWebChannel(p,h),S=!1,P=!1,O=new Au({Io:x=>{P?L(Ce,`Not sending because RPC '${e}' stream ${i} is closed:`,x):(S||(L(Ce,`Opening RPC '${e}' stream ${i} transport.`),I.open(),S=!0),L(Ce,`RPC '${e}' stream ${i} sending:`,x),I.send(x))},To:()=>I.close()}),F=(x,$,K)=>{x.listen($,H=>{try{K(H)}catch(ne){setTimeout(()=>{throw ne},0)}})};return F(I,Qn.EventType.OPEN,()=>{P||(L(Ce,`RPC '${e}' stream ${i} transport opened.`),O.yo())}),F(I,Qn.EventType.CLOSE,()=>{P||(P=!0,L(Ce,`RPC '${e}' stream ${i} transport closed`),O.So())}),F(I,Qn.EventType.ERROR,x=>{P||(P=!0,nr(Ce,`RPC '${e}' stream ${i} transport errored:`,x),O.So(new M(C.UNAVAILABLE,"The operation could not be completed")))}),F(I,Qn.EventType.MESSAGE,x=>{var $;if(!P){let K=x.data[0];te(!!K);let H=K,ne=H.error||(($=H[0])===null||$===void 0?void 0:$.error);if(ne){L(Ce,`RPC '${e}' stream ${i} received error:`,ne);let ke=ne.status,Z=function(_){let v=de[_];if(v!==void 0)return Rp(v)}(ke),w=ne.message;Z===void 0&&(Z=C.INTERNAL,w="Unknown error status: "+ke+" with message "+ne.message),P=!0,O.So(new M(Z,w)),I.close()}else L(Ce,`RPC '${e}' stream ${i} received:`,K),O.bo(K)}}),F(u,dc.STAT_EVENT,x=>{x.stat===Is.PROXY?L(Ce,`RPC '${e}' stream ${i} detected buffering proxy`):x.stat===Is.NOPROXY&&L(Ce,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{O.wo()},0),O}};function _c(){return typeof document<"u"?document:null}function so(n){return new Yc(n,!0)}var Bs=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&L("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var js=class{constructor(e,t,r,i,o,a,u,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Bs(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(It(t.toString()),It("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new M(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return L("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Cu=class extends js{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=Zv(this.serializer,e),r=function(o){if(!("targetChange"in o))return z.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?z.min():a.readTime?ot(a.readTime):z.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=tu(this.serializer),t.addTarget=function(o,a){let u,h=a.target;if(u=qc(h)?{documents:nI(o,h)}:{query:rI(o,h)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=kp(o,a.resumeToken);let d=Xc(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(z.min())>0){u.readTime=Ls(o,a.snapshotVersion.toTimestamp());let d=Xc(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=sI(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=tu(this.serializer),t.removeTarget=e,this.a_(t)}},Pu=class extends js{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return te(!!e.streamToken),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=tI(e.writeResults,e.commitTime),r=ot(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=tu(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>eI(this.serializer,r))};this.a_(t)}};var Ru=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new M(C.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Zc(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(C.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Zc(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(C.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},ku=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(It(t),this.D_=!1):L("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Du=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){Tn(this)&&(L("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=j(h);d.L_.add(4),yield Ti(d),d.q_.set("Unknown"),d.L_.delete(4),yield oo(d)})}(this))}))}),this.q_=new ku(r,i)}};function oo(n){return y(this,null,function*(){if(Tn(n))for(let e of n.B_)yield e(!0)})}function Ti(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Up(n,e){let t=j(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),fl(t)?dl(t):gr(t).r_()&&hl(t,e))}function ll(n,e){let t=j(n),r=gr(t);t.N_.delete(e),r.r_()&&qp(t,e),t.N_.size===0&&(r.r_()?r.o_():Tn(t)&&t.q_.set("Unknown"))}function hl(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(z.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}gr(n).A_(e)}function qp(n,e){n.Q_.xe(e),gr(n).R_(e)}function dl(n){n.Q_=new Jc({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),gr(n).start(),n.q_.v_()}function fl(n){return Tn(n)&&!gr(n).n_()&&n.N_.size>0}function Tn(n){return j(n).L_.size===0}function Bp(n){n.Q_=void 0}function vI(n){return y(this,null,function*(){n.q_.set("Online")})}function II(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{hl(n,e)})})}function wI(n,e){return y(this,null,function*(){Bp(n),fl(n)?(n.q_.M_(e),dl(n)):n.q_.set("Unknown")})}function EI(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof Vs&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){L("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield zs(n,r)}else if(e instanceof er?n.Q_.Ke(e):e instanceof Os?n.Q_.He(e):n.Q_.We(e),!t.isEqual(z.min()))try{let r=yield Fp(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let u=o.Q_.rt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(d);p&&o.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(Re.EMPTY_BYTE_STRING,p.snapshotVersion)),qp(o,h);let I=new fi(p.target,h,d,p.sequenceNumber);hl(o,I)}),o.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){L("RemoteStore","Failed to raise snapshot:",r),yield zs(n,r)}})}function zs(n,e,t){return y(this,null,function*(){if(!Ei(e))throw e;n.L_.add(1),yield Ti(n),n.q_.set("Offline"),t||(t=()=>Fp(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){L("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield oo(n)}))})}function jp(n,e){return e().catch(t=>zs(n,t,e))}function ao(n){return y(this,null,function*(){let e=j(n),t=Kt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;TI(e);)try{let i=yield mI(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,bI(e,i)}catch(i){yield zs(e,i)}zp(e)&&$p(e)})}function TI(n){return Tn(n)&&n.O_.length<10}function bI(n,e){n.O_.push(e);let t=Kt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function zp(n){return Tn(n)&&!Kt(n).n_()&&n.O_.length>0}function $p(n){Kt(n).start()}function AI(n){return y(this,null,function*(){Kt(n).p_()})}function SI(n){return y(this,null,function*(){let e=Kt(n);for(let t of n.O_)e.m_(t.mutations)})}function CI(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=Wc.from(r,e,t);yield jp(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ao(n)})}function PI(n,e){return y(this,null,function*(){e&&Kt(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return Gv(a)&&a!==C.ABORTED}(i.code)){let o=r.O_.shift();Kt(r).s_(),yield jp(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield ao(r)}})}(n,e)),zp(n)&&$p(n)})}function Kf(n,e){return y(this,null,function*(){let t=j(n);t.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");let r=Tn(t);t.L_.add(3),yield Ti(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield oo(t)})}function RI(n,e){return y(this,null,function*(){let t=j(n);e?(t.L_.delete(2),yield oo(t)):e||(t.L_.add(2),yield Ti(t),t.q_.set("Unknown"))})}function gr(n){return n.K_||(n.K_=function(t,r,i){let o=j(t);return o.w_(),new Cu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:vI.bind(null,n),Ro:II.bind(null,n),mo:wI.bind(null,n),d_:EI.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),fl(n)?dl(n):n.q_.set("Unknown")):(yield n.K_.stop(),Bp(n))}))),n.K_}function Kt(n){return n.U_||(n.U_=function(t,r,i){let o=j(t);return o.w_(),new Pu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:AI.bind(null,n),mo:PI.bind(null,n),f_:SI.bind(null,n),g_:CI.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield ao(n)):(yield n.U_.stop(),n.O_.length>0&&(L("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var xu=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new vt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function pl(n,e){if(It("AsyncQueue",`${e}: ${n}`),Ei(n))return new M(C.UNAVAILABLE,`${e}: ${n}`);throw n}var $s=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||U.comparator(t.key,r.key):(t,r)=>U.comparator(t.key,r.key),this.keyedMap=ri(),this.sortedSet=new le(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Gs=class{constructor(){this.W_=new le(U.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):B():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},hr=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,$s.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ro(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Nu=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Ou=class{constructor(){this.queries=Hf(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=j(t),o=i.queries;i.queries=Hf(),o.forEach((a,u)=>{for(let h of u.j_)h.onError(r)})})(this,new M(C.ABORTED,"Firestore shutting down"))}};function Hf(){return new Wt(n=>_p(n),ro)}function kI(n,e){return y(this,null,function*(){let t=j(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new Nu,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=pl(a,`Initialization of query '${Jn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&ml(t)})}function DI(n,e){return y(this,null,function*(){let t=j(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function xI(n,e){let t=j(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&ml(t)}function NI(n,e,t){let r=j(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function ml(n){n.Y_.forEach(e=>{e.next()})}var Vu,Qf;(Qf=Vu||(Vu={})).ea="default",Qf.Cache="cache";var Mu=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new hr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=hr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Vu.Cache}};var Ws=class{constructor(e){this.key=e}},Ks=class{constructor(e){this.key=e}},Lu=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=W(),this.mutatedKeys=W(),this.Aa=yp(e),this.Ra=new $s(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Gs,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,I)=>{let S=i.get(p),P=io(this.query,I)?I:null,O=!!S&&this.mutatedKeys.has(S.key),F=!!P&&(P.hasLocalMutations||this.mutatedKeys.has(P.key)&&P.hasCommittedMutations),x=!1;S&&P?S.data.isEqual(P.data)?O!==F&&(r.track({type:3,doc:P}),x=!0):this.ga(S,P)||(r.track({type:2,doc:P}),x=!0,(h&&this.Aa(P,h)>0||d&&this.Aa(P,d)<0)&&(u=!0)):!S&&P?(r.track({type:0,doc:P}),x=!0):S&&!P&&(r.track({type:1,doc:S}),x=!0,(h||d)&&(u=!0)),x&&(P?(a=a.add(P),o=F?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,I)=>function(P,O){let F=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return F(P)-F(O)}(p.type,I.type)||this.Aa(p.doc,I.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new hr(this.query,e.Ra,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Gs,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=W(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Ks(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Ws(r))}),t}ba(e){this.Ta=e.Ts,this.da=W();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return hr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Fu=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Uu=class{constructor(e){this.key=e,this.va=!1}},qu=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Wt(u=>_p(u),ro),this.Ma=new Map,this.xa=new Set,this.Oa=new le(U.comparator),this.Na=new Map,this.La=new mi,this.Ba={},this.ka=new Map,this.qa=pi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function OI(n,e,t=!0){return y(this,null,function*(){let r=Jp(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield Gp(r,e,t,!0),i})}function VI(n,e){return y(this,null,function*(){let t=Jp(n);yield Gp(t,e,!0,!1)})}function Gp(n,e,t,r){return y(this,null,function*(){let i=yield gI(n.localStore,st(e)),o=i.targetId,a=t?n.sharedClientState.addLocalQueryTarget(o):"not-current",u;return r&&(u=yield MI(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Up(n.remoteStore,i),u})}function MI(n,e,t,r,i){return y(this,null,function*(){n.Ka=(I,S,P)=>function(F,x,$,K){return y(this,null,function*(){let H=x.view.ma($);H.ns&&(H=yield Wf(F.localStore,x.query,!1).then(({documents:w})=>x.view.ma(w,H)));let ne=K&&K.targetChanges.get(x.targetId),ke=K&&K.targetMismatches.get(x.targetId)!=null,Z=x.view.applyChanges(H,F.isPrimaryClient,ne,ke);return Yf(F,x.targetId,Z.wa),Z.snapshot})}(n,I,S,P);let o=yield Wf(n.localStore,e,!0),a=new Lu(e,o.Ts),u=a.ma(o.documents),h=di.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);Yf(n,t,d.wa);let p=new Fu(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function LI(n,e,t){return y(this,null,function*(){let r=j(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!ro(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Eu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&ll(r.remoteStore,i.targetId),Bu(r,i.targetId)}).catch(wi))):(Bu(r,i.targetId),yield Eu(r.localStore,i.targetId,!0))})}function FI(n,e){return y(this,null,function*(){let t=j(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ll(t.remoteStore,r.targetId))})}function UI(n,e,t){return y(this,null,function*(){let r=WI(n);try{let i=yield function(a,u){let h=j(a),d=ge.now(),p=u.reduce((P,O)=>P.add(O.key),W()),I,S;return h.persistence.runTransaction("Locally write mutations","readwrite",P=>{let O=Et(),F=W();return h.cs.getEntries(P,p).next(x=>{O=x,O.forEach(($,K)=>{K.isValidDocument()||(F=F.add($))})}).next(()=>h.localDocuments.getOverlayedDocuments(P,O)).next(x=>{I=x;let $=[];for(let K of u){let H=$v(K,I.get(K.key).overlayedDocument);H!=null&&$.push(new Tt(K.key,H,lp(H.value.mapValue),pn.exists(!0)))}return h.mutationQueue.addMutationBatch(P,d,$,u)}).next(x=>{S=x;let $=x.applyToLocalDocumentSet(I,F);return h.documentOverlayCache.saveOverlays(P,x.batchId,$)})}).then(()=>({batchId:S.batchId,changes:Ip(I)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new le(X)),d=d.insert(u,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield bi(r,i.changes),yield ao(r.remoteStore)}catch(i){let o=pl(i,"Failed to persist write");t.reject(o)}})}function Wp(n,e){return y(this,null,function*(){let t=j(n);try{let r=yield fI(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Na.get(o);a&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?te(a.va):i.removedDocuments.size>0&&(te(a.va),a.va=!1))}),yield bi(t,r,e)}catch(r){yield wi(r)}})}function Jf(n,e,t){let r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let h=j(a);h.onlineState=u;let d=!1;h.queries.forEach((p,I)=>{for(let S of I.j_)S.Z_(u)&&(d=!0)}),d&&ml(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function qI(n,e,t){return y(this,null,function*(){let r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let a=new le(U.comparator);a=a.insert(o,Je.newNoDocument(o,z.min()));let u=W().add(o),h=new Ns(z.min(),new Map,new le(X),a,u);yield Wp(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),gl(r)}else yield Eu(r.localStore,e,!1).then(()=>Bu(r,e,t)).catch(wi)})}function BI(n,e){return y(this,null,function*(){let t=j(n),r=e.batch.batchId;try{let i=yield dI(t.localStore,e);Hp(t,r,null),Kp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield bi(t,i)}catch(i){yield wi(i)}})}function jI(n,e,t){return y(this,null,function*(){let r=j(n);try{let i=yield function(a,u){let h=j(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(I=>(te(I!==null),p=I.keys(),h.mutationQueue.removeMutationBatch(d,I))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);Hp(r,e,t),Kp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield bi(r,i)}catch(i){yield wi(i)}})}function Kp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Hp(n,e,t){let r=j(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Bu(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Qp(n,r)})}function Qp(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(ll(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),gl(n))}function Yf(n,e,t){for(let r of t)r instanceof Ws?(n.La.addReference(r.key,e),zI(n,r)):r instanceof Ks?(L("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Qp(n,r.key)):B()}function zI(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(L("SyncEngine","New document in limbo: "+t),n.xa.add(r),gl(n))}function gl(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new U(oe.fromString(e)),r=n.qa.next();n.Na.set(r,new Uu(t)),n.Oa=n.Oa.insert(t,r),Up(n.remoteStore,new fi(st(al(t.path)),r,"TargetPurposeLimboResolution",op.oe))}}function bi(n,e,t){return y(this,null,function*(){let r=j(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let I=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,I?"current":"not-current")}if(d){i.push(d);let I=yu.Wi(h.targetId,d);o.push(I)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return y(this,null,function*(){let p=j(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",I=>k.forEach(d,S=>k.forEach(S.$i,P=>p.persistence.referenceDelegate.addReference(I,S.targetId,P)).next(()=>k.forEach(S.Ui,P=>p.persistence.referenceDelegate.removeReference(I,S.targetId,P)))))}catch(I){if(!Ei(I))throw I;L("LocalStore","Failed to update sequence numbers: "+I)}for(let I of d){let S=I.targetId;if(!I.fromCache){let P=p.os.get(S),O=P.snapshotVersion,F=P.withLastLimboFreeSnapshotVersion(O);p.os=p.os.insert(S,F)}}})}(r.localStore,o))})}function $I(n,e){return y(this,null,function*(){let t=j(n);if(!t.currentUser.isEqual(e)){L("SyncEngine","User change. New user:",e.toKey());let r=yield Lp(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(u=>{u.forEach(h=>{h.reject(new M(C.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield bi(t,r.hs)}})}function GI(n,e){let t=j(n),r=t.Na.get(e);if(r&&r.va)return W().add(r.key);{let i=W(),o=t.Ma.get(e);if(!o)return i;for(let a of o){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function Jp(n){let e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wp.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=GI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qI.bind(null,e),e.Ca.d_=xI.bind(null,e.eventManager),e.Ca.$a=NI.bind(null,e.eventManager),e}function WI(n){let e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=BI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=jI.bind(null,e),e}var Hs=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=so(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return hI(this.persistence,new Iu,e.initialUser,this.serializer)}createPersistence(e){return new mu(_u.Zr,this.serializer)}createSharedClientState(e){return new Tu}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var ju=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Jf(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$I.bind(null,this.syncEngine),yield RI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Ou}()}createDatastore(e){let t=so(e.databaseInfo.databaseId),r=function(o){return new Su(o)}(e.databaseInfo);return function(o,a,u,h){return new Ru(o,a,u,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,a,u){return new Du(r,i,o,a,u)}(this.localStore,this.datastore,e.asyncQueue,t=>Jf(this.syncEngine,t,0),function(){return qs.D()?new qs:new bu}())}createSyncEngine(e,t){return function(i,o,a,u,h,d,p){let I=new qu(i,o,a,u,h,d);return p&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e,t;yield function(i){return y(this,null,function*(){let o=j(i);L("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield Ti(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};var zu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):It("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var $u=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ye.UNAUTHENTICATED,this.clientId=Ss.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>y(this,null,function*(){L("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(L("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new vt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=pl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function yc(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield Lp(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Xf(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield HI(n);L("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Kf(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Kf(e.remoteStore,i)),n._onlineComponents=e})}function KI(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function HI(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){L("FirestoreClient","Using user provided OfflineComponentProvider");try{yield yc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!KI(t))throw t;nr("Error using user provided cache. Falling back to memory cache: "+t),yield yc(n,new Hs)}}else L("FirestoreClient","Using default OfflineComponentProvider"),yield yc(n,new Hs);return n._offlineComponents})}function Yp(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(L("FirestoreClient","Using user provided OnlineComponentProvider"),yield Xf(n,n._uninitializedComponentsProvider._online)):(L("FirestoreClient","Using default OnlineComponentProvider"),yield Xf(n,new ju))),n._onlineComponents})}function QI(n){return Yp(n).then(e=>e.syncEngine)}function Zf(n){return y(this,null,function*(){let e=yield Yp(n),t=e.eventManager;return t.onListen=OI.bind(null,e.syncEngine),t.onUnlisten=LI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=VI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=FI.bind(null,e.syncEngine),t})}function Xp(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var ep=new Map;function Zp(n,e,t){if(!t)throw new M(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function JI(n,e,t,r){if(e===!0&&r===!0)throw new M(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function tp(n){if(!U.isDocumentKey(n))throw new M(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function np(n){if(U.isDocumentKey(n))throw new M(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function co(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B()}function ci(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=co(n);throw new M(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Qs=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xp((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new M(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new M(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new M(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},dr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qs({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qs(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new vc;switch(r.type){case"firstParty":return new Tc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=ep.get(t);r&&(L("ComponentProvider","Removing Datastore"),ep.delete(t),r.terminate())}(this),Promise.resolve()}};function em(n,e,t,r={}){var i;let o=(n=ci(n,dr))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&nr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let u,h;if(typeof r.mockUserToken=="string")u=r.mockUserToken,h=ye.MOCK_USER;else{u=Xh(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new M(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new ye(d)}n._authCredentials=new Ic(new As(u,h))}}var En=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ue=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},zt=class n extends En{constructor(e,t,r){super(e,t,al(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ue(this.firestore,null,new U(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function tm(n,e,...t){if(n=Se(n),Zp("collection","path",e),n instanceof dr){let r=oe.fromString(e,...t);return np(r),new zt(n,null,r)}{if(!(n instanceof Ue||n instanceof zt))throw new M(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return np(r),new zt(n.firestore,null,r)}}function nm(n,e,...t){if(n=Se(n),arguments.length===1&&(e=Ss.newId()),Zp("doc","path",e),n instanceof dr){let r=oe.fromString(e,...t);return tp(r),new Ue(n,null,new U(r))}{if(!(n instanceof Ue||n instanceof zt))throw new M(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return tp(r),new Ue(n.firestore,n instanceof zt?n.converter:null,new U(r))}}var Gu=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new Bs(this,"async_queue_retry"),this.Eu=()=>{let t=_c();t&&L("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=_c();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=_c();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new vt;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return y(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Ei(e))throw e;L("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw It("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=xu.createAndSchedule(this,e,t,r,o=>this.Vu(o));return this.lu.push(i),i}du(){this.hu&&B()}verifyOperationInProgress(){}mu(){return y(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function rp(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var fr=class extends dr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new Gu}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||sm(this),this._firestoreClient.terminate()}};function rm(n,e){let t=typeof n=="object"?n:zn(),r=typeof n=="string"?n:e||"(default)",i=$r(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Yh("firestore");o&&em(i,...o)}return i}function im(n){return n._firestoreClient||sm(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function sm(n){var e,t,r;let i=n._freezeSettings(),o=function(u,h,d,p){return new Pc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Xp(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new $u(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var gi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Re.fromBase64String(e))}catch(t){throw new M(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Re.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var _i=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Js=class{constructor(e){this._methodName=e}};var yi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}};var vi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var YI=/^__.*__$/,Wu=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Tt(e,this.data,this.fieldMask,t,this.fieldTransforms):new wn(e,this.data,t,this.fieldTransforms)}};function om(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}var Ku=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.yu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return Ys(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(om(this.wu)&&YI.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Hu=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||so(e)}Nu(e,t,r,i=!1){return new Ku({wu:e,methodName:t,Ou:r,path:Fe.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function am(n){let e=n._freezeSettings(),t=so(n._databaseId);return new Hu(n._databaseId,!!e.ignoreUndefinedProperties,t)}function XI(n,e,t,r,i,o={}){let a=n.Nu(o.merge||o.mergeFields?2:0,e,t,i);lm("Data must be an object, but it was:",a,r);let u=cm(r,a),h,d;if(o.merge)h=new rt(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let I of o.mergeFields){let S=ew(e,I,t);if(!a.contains(S))throw new M(C.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);nw(p,S)||p.push(S)}h=new rt(p),d=a.fieldTransforms.filter(I=>h.covers(I.field))}else h=null,d=a.fieldTransforms;return new Wu(new Qe(u),h,d)}function ZI(n,e,t,r=!1){return _l(t,n.Nu(r?4:3,e))}function _l(n,e){if(um(n=Se(n)))return lm("Unsupported field value:",e,n),cm(n,e);if(n instanceof Js)return function(r,i){if(!om(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let u of r){let h=_l(u,i.Fu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Se(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Uv(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ge.fromDate(r);return{timestampValue:Ls(i.serializer,o)}}if(r instanceof ge){let o=new ge(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ls(i.serializer,o)}}if(r instanceof yi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gi)return{bytesValue:kp(i.serializer,r._byteString)};if(r instanceof Ue){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Mu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ul(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof vi)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw u.Mu("VectorValues must only contain numeric values.");return cl(u.serializer,h)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${co(r)}`)}(n,e)}function cm(n,e){let t={};return ap(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mr(n,(r,i)=>{let o=_l(i,e.bu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function um(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ge||n instanceof yi||n instanceof gi||n instanceof Ue||n instanceof Js||n instanceof vi)}function lm(n,e,t){if(!um(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=co(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function ew(n,e,t){if((e=Se(e))instanceof _i)return e._internalPath;if(typeof e=="string")return hm(n,e);throw Ys("Field path arguments must be of type string or ",n,!1,void 0,t)}var tw=new RegExp("[~\\*/\\[\\]]");function hm(n,e,t){if(e.search(tw)>=0)throw Ys(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _i(...e.split("."))._internalPath}catch{throw Ys(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ys(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new M(C.INVALID_ARGUMENT,u+n+h)}function nw(n,e){return n.some(t=>t.isEqual(e))}var Xs=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ue(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Qu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(yl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Qu=class extends Xs{data(){return super.data()}};function yl(n,e){return typeof e=="string"?hm(n,e):e instanceof _i?e._internalPath:e._delegate._internalPath}function rw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ii=class{},Zs=class extends Ii{};function dm(n,e,...t){let r=[];e instanceof Ii&&r.push(e),r=r.concat(t),function(o){let a=o.filter(h=>h instanceof Yu).length,u=o.filter(h=>h instanceof Ju).length;if(a>1||a>0&&u>0)throw new M(C.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Ju=class n extends Zs{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return pm(e._query,t),new En(e.firestore,e.converter,Bc(e._query,t))}_parse(e){let t=am(e.firestore);return function(o,a,u,h,d,p,I){let S;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new M(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){sp(I,p);let P=[];for(let O of I)P.push(ip(h,o,O));S={arrayValue:{values:P}}}else S=ip(h,o,I)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||sp(I,p),S=ZI(u,a,I,p==="in"||p==="not-in");return pe.create(d,p,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Yu=class n extends Ii{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ye.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let a=i,u=o.getFlattenedFilters();for(let h of u)pm(a,h),a=Bc(a,h)}(e._query,t),new En(e.firestore,e.converter,Bc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Xu=class n extends Zs{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,a){if(i.startAt!==null)throw new M(C.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(C.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yn(o,a)}(e._query,this._field,this._direction);return new En(e.firestore,e.converter,function(i,o){let a=i.explicitOrderBy.concat([o]);return new Gt(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function fm(n,e="asc"){let t=e,r=yl("orderBy",n);return Xu._create(r,t)}function ip(n,e,t){if(typeof(t=Se(t))=="string"){if(t==="")throw new M(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gp(e)&&t.indexOf("/")!==-1)throw new M(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(oe.fromString(t));if(!U.isDocumentKey(r))throw new M(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Rf(n,new U(r))}if(t instanceof Ue)return Rf(n,t._key);throw new M(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${co(t)}.`)}function sp(n,e){if(!Array.isArray(n)||n.length===0)throw new M(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pm(n,e){let t=function(i,o){for(let a of i)for(let u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Zu=class{convertValue(e,t="none"){switch(_n(e)){case 0:return null;case 1:return e.booleanValue;case 2:return se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes($t(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw B()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return mr(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>se(a.doubleValue));return new vi(o)}convertGeoPoint(e){return new yi(se(e.latitude),se(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=rl(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(li(e));default:return null}}convertTimestamp(e){let t=wt(e);return new ge(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=oe.fromString(e);te(Mp(r));let i=new ks(r.get(1),r.get(3)),o=new U(r.popFirst(5));return i.isEqual(t)||It(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function iw(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var fn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},eo=class extends Xs{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new tr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(yl("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},tr=class extends eo{data(e={}){return super.data(e)}},el=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new fn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new tr(this._firestore,this._userDataWriter,r.key,r,new fn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new tr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new fn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new tr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new fn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:sw(u.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function sw(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}var to=class extends Zu{constructor(e){super(),this.firestore=e}convertBytes(e){return new gi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ue(this.firestore,null,t)}};function mm(n,e){let t=ci(n.firestore,fr),r=nm(n),i=iw(n.converter,e);return ow(t,[XI(am(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,pn.exists(!1))]).then(()=>r)}function vl(n,...e){var t,r,i;n=Se(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||rp(e[a])||(o=e[a],a++);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(rp(e[a])){let I=e[a];e[a]=(t=I.next)===null||t===void 0?void 0:t.bind(I),e[a+1]=(r=I.error)===null||r===void 0?void 0:r.bind(I),e[a+2]=(i=I.complete)===null||i===void 0?void 0:i.bind(I)}let h,d,p;if(n instanceof Ue)d=ci(n.firestore,fr),p=al(n._key.path),h={next:I=>{e[a]&&e[a](aw(d,n,I))},error:e[a+1],complete:e[a+2]};else{let I=ci(n,En);d=ci(I.firestore,fr),p=I._query;let S=new to(d);h={next:P=>{e[a]&&e[a](new el(d,S,I,P))},error:e[a+1],complete:e[a+2]},rw(n._query)}return function(S,P,O,F){let x=new zu(F),$=new Mu(P,x,O);return S.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return kI(yield Zf(S),$)})),()=>{x.za(),S.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return DI(yield Zf(S),$)}))}}(im(d),p,u,h)}function ow(n,e){return function(r,i){let o=new vt;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return UI(yield QI(r),i,o)})),o.promise}(im(n),e)}function aw(n,e,t){let r=t.docs.get(e._key),i=new to(n);return new eo(n,i,e._key,r,new fn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){pr=i})(Lt),Mt(new ze("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new fr(new wc(r.getProvider("auth-internal")),new Ac(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new M(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ks(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),me(Af,"4.7.1",e),me(Af,"4.7.1","esm2017")})();var uo=function(){return uo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},uo.apply(this,arguments)};var lw={includeMetadataChanges:!1};function gm(n,e){return e===void 0&&(e=lw),new Lr(function(t){var r=vl(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function _m(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:uo(uo({},r),(t={},t[e.idField]=n.id,t))}function ym(n){return gm(n,{includeMetadataChanges:!0}).pipe(Jo(function(e){return e.docs}))}function vm(n,e){return e===void 0&&(e={}),ym(n).pipe(Jo(function(t){return t.map(function(r){return _m(r,e)})}))}var bt=class{constructor(e){return e}},Im="firestore",Il=class{constructor(){return Gr(Im)}};var wl=new Pn("angularfire2.firestore-instances");function hw(n,e){let t=Zi(Im,n,e);return t&&new bt(t)}function dw(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new bt(r)}}var fw={provide:Il,deps:[[new qe,wl]]},pw={provide:bt,useFactory:hw,deps:[[new qe,wl],pt]};function wm(n,...e){return me("angularfire",sn.full,"fst"),Rn([pw,fw,{provide:wl,useFactory:dw(n),multi:!0,deps:[kt,kn,Wn,on,[new qe,ei],[new qe,Gn],...e]}])}var lo=Le(vm,!0);var ho=Le(mm,!0);var _r=Le(tm,!0);var Em=Le(rm,!0);var Tm=Le(fm,!0);var fo=Le(dm,!0);var mw=()=>["/registro"];function gw(n,e){n&1&&ce(0,"div",15)}function _w(n,e){if(n&1&&(N(0,"div",16),V(1),R()),n&2){let t=Oe();J(),zi(" ",t.errorMessage," ")}}var po=class n{constructor(e,t,r,i){this.router=e;this.firestore=t;this.auth=r;this.userService=i}user;email="";password="";errorMessage="";isLoading=!1;loginsCollection=[];countLogins=0;sub;ngOnInit(){localStorage.getItem("user")&&this.router.navigate(["/home"])}onLogin(){this.user=new qn(this.email,this.password),this.isLoading=!0,Ef(this.auth,this.user.getEmail(),this.user.getPassword()).then(e=>{localStorage.setItem("user",JSON.stringify({email:this.auth.currentUser?.email})),this.userService.login(),this.router.navigate(["/home"]),this.logUsuarios()}).catch(e=>{this.errorMessage="Usuario no encontrado."}).finally(()=>{this.isLoading=!1})}logUsuarios(){let e=_r(this.firestore,"logins"),t={fecha:new Date,email:this.user.getEmail()};ho(e,t)}getData(){let e=_r(this.firestore,"logins"),t=fo(e),r=lo(t);this.sub=r.subscribe(i=>{this.loginsCollection=i,this.countLogins=this.loginsCollection.length,console.log(i)})}quickLogin(e,t){this.email=e,this.password=t}static \u0275fac=function(t){return new(t||n)(he(Xe),he(bt),he(He),he(je))};static \u0275cmp=be({type:n,selectors:[["app-login"]],standalone:!0,features:[Ae],decls:28,vars:7,consts:[[1,"login-section"],[1,"login-container"],[1,"login-form",3,"ngSubmit"],[1,"form-group"],["for","Email"],["id","email","name","email","required","","autocomplete","email",3,"ngModelChange","ngModel"],["for","clave"],["id","clave","name","password","type","password","required","","autocomplete","current-password",3,"ngModelChange","ngModel"],["type","submit",1,"btn_login",3,"disabled"],["class","spinner",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"quick-login-buttons"],[3,"click"],[1,"register-link"],[3,"routerLink"],[1,"spinner"],[1,"error-message"]],template:function(t,r){t&1&&(N(0,"section",0)(1,"div",1)(2,"h1"),V(3,"Login"),R(),N(4,"form",2),ue("ngSubmit",function(){return r.onLogin()}),N(5,"div",3)(6,"label",4),V(7,"Email:"),R(),N(8,"input",5),Nt("ngModelChange",function(o){return xt(r.email,o)||(r.email=o),o}),R()(),N(9,"div",3)(10,"label",6),V(11,"Clave:"),R(),N(12,"input",7),Nt("ngModelChange",function(o){return xt(r.password,o)||(r.password=o),o}),R()(),N(13,"div",3)(14,"button",8),V(15,"Login"),R()(),Ne(16,gw,1,0,"div",9)(17,_w,2,1,"div",10),R(),N(18,"div",11)(19,"button",12),ue("click",function(){return r.quickLogin("pepe@gmail.com","pepe123")}),V(20,"Login como Pepe"),R(),N(21,"button",12),ue("click",function(){return r.quickLogin("romeo@gmail.com","Romeo123")}),V(22,"Login como Romeo"),R()(),N(23,"div",13)(24,"p"),V(25,"No tienes cuenta? "),N(26,"a",14),V(27,"Reg\xEDstrate aqu\xED"),R()()()()()),t&2&&(J(8),Dt("ngModel",r.email),J(4),Dt("ngModel",r.password),J(2),ie("disabled",r.isLoading),J(2),ie("ngIf",r.isLoading),J(),ie("ngIf",r.errorMessage),J(9),ie("routerLink",Fr(6,mw)))},dependencies:[Un,Ln,xn,Nn,On,Fn,Mn,Vn,Dn,Be],styles:[`.login-section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#a0b316;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='192' height='192' viewBox='0 0 192 192'%3E%3Cpath fill='%23ffffff' fill-opacity='0.91' d='M192 15v2a11 11 0 0 0-11 11c0 1.94 1.16 4.75 2.53 6.11l2.36 2.36a6.93 6.93 0 0 1 1.22 7.56l-.43.84a8.08 8.08 0 0 1-6.66 4.13H145v35.02a6.1 6.1 0 0 0 3.03 4.87l.84.43c1.58.79 4 .4 5.24-.85l2.36-2.36a12.04 12.04 0 0 1 7.51-3.11 13 13 0 1 1 .02 26 12 12 0 0 1-7.53-3.11l-2.36-2.36a4.93 4.93 0 0 0-5.24-.85l-.84.43a6.1 6.1 0 0 0-3.03 4.87V143h35.02a8.08 8.08 0 0 1 6.66 4.13l.43.84a6.91 6.91 0 0 1-1.22 7.56l-2.36 2.36A10.06 10.06 0 0 0 181 164a11 11 0 0 0 11 11v2a13 13 0 0 1-13-13 12 12 0 0 1 3.11-7.53l2.36-2.36a4.93 4.93 0 0 0 .85-5.24l-.43-.84a6.1 6.1 0 0 0-4.87-3.03H145v35.02a8.08 8.08 0 0 1-4.13 6.66l-.84.43a6.91 6.91 0 0 1-7.56-1.22l-2.36-2.36A10.06 10.06 0 0 0 124 181a11 11 0 0 0-11 11h-2a13 13 0 0 1 13-13c2.47 0 5.79 1.37 7.53 3.11l2.36 2.36a4.94 4.94 0 0 0 5.24.85l.84-.43a6.1 6.1 0 0 0 3.03-4.87V145h-35.02a8.08 8.08 0 0 1-6.66-4.13l-.43-.84a6.91 6.91 0 0 1 1.22-7.56l2.36-2.36A10.06 10.06 0 0 0 107 124a11 11 0 0 0-22 0c0 1.94 1.16 4.75 2.53 6.11l2.36 2.36a6.93 6.93 0 0 1 1.22 7.56l-.43.84a8.08 8.08 0 0 1-6.66 4.13H49v35.02a6.1 6.1 0 0 0 3.03 4.87l.84.43c1.58.79 4 .4 5.24-.85l2.36-2.36a12.04 12.04 0 0 1 7.51-3.11A13 13 0 0 1 81 192h-2a11 11 0 0 0-11-11c-1.94 0-4.75 1.16-6.11 2.53l-2.36 2.36a6.93 6.93 0 0 1-7.56 1.22l-.84-.43a8.08 8.08 0 0 1-4.13-6.66V145H11.98a6.1 6.1 0 0 0-4.87 3.03l-.43.84c-.79 1.58-.4 4 .85 5.24l2.36 2.36a12.04 12.04 0 0 1 3.11 7.51A13 13 0 0 1 0 177v-2a11 11 0 0 0 11-11c0-1.94-1.16-4.75-2.53-6.11l-2.36-2.36a6.93 6.93 0 0 1-1.22-7.56l.43-.84a8.08 8.08 0 0 1 6.66-4.13H47v-35.02a6.1 6.1 0 0 0-3.03-4.87l-.84-.43c-1.59-.8-4-.4-5.24.85l-2.36 2.36A12 12 0 0 1 28 109a13 13 0 1 1 0-26c2.47 0 5.79 1.37 7.53 3.11l2.36 2.36a4.94 4.94 0 0 0 5.24.85l.84-.43A6.1 6.1 0 0 0 47 84.02V49H11.98a8.08 8.08 0 0 1-6.66-4.13l-.43-.84a6.91 6.91 0 0 1 1.22-7.56l2.36-2.36A10.06 10.06 0 0 0 11 28 11 11 0 0 0 0 17v-2a13 13 0 0 1 13 13c0 2.47-1.37 5.79-3.11 7.53l-2.36 2.36a4.94 4.94 0 0 0-.85 5.24l.43.84A6.1 6.1 0 0 0 11.98 47H47V11.98a8.08 8.08 0 0 1 4.13-6.66l.84-.43a6.91 6.91 0 0 1 7.56 1.22l2.36 2.36A10.06 10.06 0 0 0 68 11 11 11 0 0 0 79 0h2a13 13 0 0 1-13 13 12 12 0 0 1-7.53-3.11l-2.36-2.36a4.93 4.93 0 0 0-5.24-.85l-.84.43A6.1 6.1 0 0 0 49 11.98V47h35.02a8.08 8.08 0 0 1 6.66 4.13l.43.84a6.91 6.91 0 0 1-1.22 7.56l-2.36 2.36A10.06 10.06 0 0 0 85 68a11 11 0 0 0 22 0c0-1.94-1.16-4.75-2.53-6.11l-2.36-2.36a6.93 6.93 0 0 1-1.22-7.56l.43-.84a8.08 8.08 0 0 1 6.66-4.13H143V11.98a6.1 6.1 0 0 0-3.03-4.87l-.84-.43c-1.59-.8-4-.4-5.24.85l-2.36 2.36A12 12 0 0 1 124 13a13 13 0 0 1-13-13h2a11 11 0 0 0 11 11c1.94 0 4.75-1.16 6.11-2.53l2.36-2.36a6.93 6.93 0 0 1 7.56-1.22l.84.43a8.08 8.08 0 0 1 4.13 6.66V47h35.02a6.1 6.1 0 0 0 4.87-3.03l.43-.84c.8-1.59.4-4-.85-5.24l-2.36-2.36A12 12 0 0 1 179 28a13 13 0 0 1 13-13zM84.02 143a6.1 6.1 0 0 0 4.87-3.03l.43-.84c.8-1.59.4-4-.85-5.24l-2.36-2.36A12 12 0 0 1 83 124a13 13 0 1 1 26 0c0 2.47-1.37 5.79-3.11 7.53l-2.36 2.36a4.94 4.94 0 0 0-.85 5.24l.43.84a6.1 6.1 0 0 0 4.87 3.03H143v-35.02a8.08 8.08 0 0 1 4.13-6.66l.84-.43a6.91 6.91 0 0 1 7.56 1.22l2.36 2.36A10.06 10.06 0 0 0 164 107a11 11 0 0 0 0-22c-1.94 0-4.75 1.16-6.11 2.53l-2.36 2.36a6.93 6.93 0 0 1-7.56 1.22l-.84-.43a8.08 8.08 0 0 1-4.13-6.66V49h-35.02a6.1 6.1 0 0 0-4.87 3.03l-.43.84c-.79 1.58-.4 4 .85 5.24l2.36 2.36a12.04 12.04 0 0 1 3.11 7.51A13 13 0 1 1 83 68a12 12 0 0 1 3.11-7.53l2.36-2.36a4.93 4.93 0 0 0 .85-5.24l-.43-.84A6.1 6.1 0 0 0 84.02 49H49v35.02a8.08 8.08 0 0 1-4.13 6.66l-.84.43a6.91 6.91 0 0 1-7.56-1.22l-2.36-2.36A10.06 10.06 0 0 0 28 85a11 11 0 0 0 0 22c1.94 0 4.75-1.16 6.11-2.53l2.36-2.36a6.93 6.93 0 0 1 7.56-1.22l.84.43a8.08 8.08 0 0 1 4.13 6.66V143h35.02z'%3E%3C/path%3E%3C/svg%3E");background-size:200px;background-repeat:repeat;background-position:center}.login-container[_ngcontent-%COMP%]{background:#fff;padding:4.5rem;border-radius:12px;box-shadow:0 8px 20px #0000001a;max-width:350px;width:92%;margin-top:60px}h1[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-size:2.2rem;color:#343a40;text-align:center}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-size:1rem;color:#495057}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:92%;padding:.8rem;border:1px solid #ced4da;border-radius:6px;font-size:1rem;transition:border-color .3s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 3px #007bff40}.form-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem 9.7rem}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:.8rem 1.5rem;border-radius:6px;cursor:pointer;font-size:1rem;transition:background-color .3s,transform .2s;display:block;margin:0}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}.quick-login-buttons[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:space-between}.quick-login-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#28a745;padding:.8rem 1.5rem;flex:1;margin:0 .5rem;font-size:.9rem;border-radius:6px}.register-link[_ngcontent-%COMP%]{margin-top:20px;text-align:center}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.error-message[_ngcontent-%COMP%]{color:red;font-size:.9rem;margin-top:.5rem;text-align:center}.spinner[_ngcontent-%COMP%]{border:8px solid #f3f3f3;border-top:8px solid #007a33;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:10px auto}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.login-container[_ngcontent-%COMP%]{padding:3rem}h1[_ngcontent-%COMP%]{font-size:1.8rem}.form-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem 8rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:92%;padding:.8rem .72rem}}`]})};var mo=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=be({type:n,selectors:[["app-quien-soy"]],standalone:!0,features:[Ae],decls:66,vars:0,consts:[[1,"quien-soy-section"],[1,"alumno-container"],[1,"image-section"],["src","https://gyazo.com/54e22f567e0c49fe4345d3f165d73c3a.jpg","alt","Imagen del Alumno",1,"alumno-image"],[1,"info-section"]],template:function(t,r){t&1&&(N(0,"section",0)(1,"div",1)(2,"div",2),ce(3,"img",3),R(),N(4,"div",4)(5,"h1"),V(6,"Qui\xE9n soy"),R(),N(7,"p")(8,"strong"),V(9,"Nombre:"),R(),V(10," Cristian Delgado"),R(),N(11,"p")(12,"strong"),V(13,"Edad:"),R(),V(14," 23 a\xF1os"),R(),N(15,"p")(16,"strong"),V(17,"Estudios:"),R(),V(18," Tecnicatura en Programaci\xF3n en la UTN"),R(),N(19,"h2"),V(20,"Explicaci\xF3n del Juego Propio: La Viborita"),R(),N(21,"p")(22,"strong"),V(23,"La Viborita"),R(),V(24," es un juego cl\xE1sico en el que controlas una serpiente que se mueve por un tablero. El objetivo es comer la comida que aparece en el tablero para hacer crecer a la serpiente, mientras evitas chocar contra las paredes o contra ti mismo. "),R(),N(25,"h3"),V(26,"C\xF3mo Jugar"),R(),N(27,"p")(28,"strong"),V(29,"Objetivo del Juego:"),R(),V(30," El objetivo es controlar la serpiente y comer la mayor cantidad de comida posible sin chocar con las paredes o contigo mismo. Cuanto m\xE1s comes, m\xE1s larga se vuelve la serpiente. "),R(),N(31,"p")(32,"strong"),V(33,"Inicio del Juego:"),R(),V(34," Al comenzar, la serpiente se posiciona en el centro del tablero y est\xE1 lista para moverse. Debes usar las teclas de flecha para cambiar la direcci\xF3n de la serpiente. "),R(),N(35,"p")(36,"strong"),V(37,"Movimiento:"),R(),V(38," La serpiente se mueve de forma continua en la direcci\xF3n que hayas elegido. Tienes que ser r\xE1pido para cambiar la direcci\xF3n y evitar chocar con los bordes del tablero o con la parte de tu cuerpo. "),R(),N(39,"p")(40,"strong"),V(41,"Comer Comida:"),R(),V(42," Cada vez que la serpiente come, crecer\xE1 en longitud, lo que har\xE1 que el juego se vuelva m\xE1s desafiante a medida que avanzas. "),R(),N(43,"p")(44,"strong"),V(45,"Fin del Juego:"),R(),V(46," El juego termina cuando la serpiente choca contra una pared o contra s\xED misma. Tu puntuaci\xF3n se basar\xE1 en cu\xE1nta comida hayas comido antes de perder. "),R(),N(47,"h3"),V(48,"Caracter\xEDsticas del Juego"),R(),N(49,"ul")(50,"li")(51,"strong"),V(52,"Interfaz Intuitiva:"),R(),V(53," Un dise\xF1o claro y simple para facilitar el control de la serpiente."),R(),N(54,"li")(55,"strong"),V(56,"Desaf\xEDo Progresivo:"),R(),V(57," A medida que comes m\xE1s, el juego se vuelve m\xE1s desafiante con la serpiente creciendo."),R(),N(58,"li")(59,"strong"),V(60,"Temporizador:"),R(),V(61," Mant\xE9n el ritmo y la rapidez para mejorar tus habilidades."),R(),N(62,"li")(63,"strong"),V(64,"Reinicio F\xE1cil:"),R(),V(65," Opci\xF3n para reiniciar el juego y volver a jugar inmediatamente despu\xE9s de perder."),R()()()()())},styles:[`.quien-soy-section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#000;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Cg fill='%23ffffff' fill-opacity='0.71'%3E%3Cpath fill-rule='evenodd' d='M11 0l5 20H6l5-20zm42 31a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM0 72h40v4H0v-4zm0-8h31v4H0v-4zm20-16h20v4H20v-4zM0 56h40v4H0v-4zm63-25a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm10 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM53 41a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm10 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm10 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-30 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-28-8a5 5 0 0 0-10 0h10zm10 0a5 5 0 0 1-10 0h10zM56 5a5 5 0 0 0-10 0h10zm10 0a5 5 0 0 1-10 0h10zm-3 46a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm10 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM21 0l5 20H16l5-20zm43 64v-4h-4v4h-4v4h4v4h4v-4h4v-4h-4zM36 13h4v4h-4v-4zm4 4h4v4h-4v-4zm-4 4h4v4h-4v-4zm8-8h4v4h-4v-4z'/%3E%3C/g%3E%3C/svg%3E");background-size:100px;background-repeat:repeat;background-position:center}.alumno-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:40px;max-width:800px;background-color:#ffffffe6;border-radius:12px;box-shadow:0 8px 16px #0003}.alumno-image[_ngcontent-%COMP%]{max-width:220px;border-radius:10%;border:3px solid #e0e0e0;box-shadow:0 4px 8px #0000001a}.info-section[_ngcontent-%COMP%]{max-width:100%}h1[_ngcontent-%COMP%]{font-size:2.5em;color:#333;margin-bottom:20px;font-weight:700;text-shadow:1px 1px 2px rgba(0,0,0,.1)}h2[_ngcontent-%COMP%]{font-size:2em;color:#444;margin-top:30px;margin-bottom:15px;font-weight:600;border-bottom:2px solid #007bff;padding-bottom:5px}h3[_ngcontent-%COMP%]{font-size:1.8em;color:#555;margin-top:20px;margin-bottom:10px;font-weight:500;position:relative}h3[_ngcontent-%COMP%]:before{content:"";display:block;width:50px;height:3px;background:#007bff;position:absolute;top:0;left:0}p[_ngcontent-%COMP%]{font-size:1.1em;color:#444;line-height:1.6;margin-bottom:20px;background-color:#f5f5f5cc;border-radius:8px;padding:15px}ul[_ngcontent-%COMP%]{text-align:left;margin-left:40px;list-style-type:disc}li[_ngcontent-%COMP%]{font-size:1.1em;color:#444;margin-bottom:10px}strong[_ngcontent-%COMP%]{color:#000;font-weight:700}@media (max-width: 768px){h1[_ngcontent-%COMP%]{font-size:2em}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{font-size:1.5em}p[_ngcontent-%COMP%]{font-size:1em}.image-section[_ngcontent-%COMP%]{margin-top:24px}}`]})};function yw(n,e){n&1&&(N(0,"div",12),ce(1,"div",13),R())}function vw(n,e){if(n&1&&(N(0,"div",14),V(1),R()),n&2){let t=Oe();J(),Zt(t.errorMessage)}}var go=class n{constructor(e,t){this.auth=e;this.router=t}user;email;password;errorMessage="";loading=!1;ngOnInit(){localStorage.getItem("user")&&this.router.navigate(["/home"])}onSubmit(e){this.user=new qn(this.email,this.password),this.errorMessage="",this.loading=!0,If(this.auth,this.user.getEmail(),this.user.getPassword()).then(t=>{this.loading=!1,t.user&&(console.log("Usuario creado con \xE9xito"),localStorage.setItem("user",JSON.stringify({email:t.user.email})),this.router.navigate(["/home"]))}).catch(t=>{switch(this.loading=!1,t.code){case"auth/email-already-in-use":this.errorMessage="El email ya est\xE1 en uso";break;case"auth/invalid-email":this.errorMessage="El email no es v\xE1lido";break;case"auth/weak-password":this.errorMessage="La contrase\xF1a tiene que tener al menos 6 caracteres",this.password="";break;default:this.errorMessage="Error desconocido";break}})}static \u0275fac=function(t){return new(t||n)(he(He),he(Xe))};static \u0275cmp=be({type:n,selectors:[["app-registro"]],standalone:!0,features:[Ae],decls:18,vars:5,consts:[["registroForm","ngForm"],[1,"registro-section"],[1,"registro-container"],[1,"registro-form",3,"ngSubmit"],[1,"form-group"],["for","email"],["type","email","id","email","name","email","required","","autocomplete","email",3,"ngModelChange","ngModel"],["for","contrasena"],["type","password","id","contrasena","name","contrasena","required","","autocomplete","new-password",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["class","spinner",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"spinner"],[1,"loader"],[1,"error-message"]],template:function(t,r){if(t&1){let i=Xt();N(0,"section",1)(1,"div",2)(2,"h1"),V(3,"Registro de Usuario"),R(),N(4,"form",3,0),ue("ngSubmit",function(){Ge(i);let a=Yo(5);return We(r.onSubmit(a))}),N(6,"div",4)(7,"label",5),V(8,"Email:"),R(),N(9,"input",6),Nt("ngModelChange",function(a){return Ge(i),xt(r.email,a)||(r.email=a),We(a)}),R()(),N(10,"div",4)(11,"label",7),V(12,"Contrase\xF1a:"),R(),N(13,"input",8),Nt("ngModelChange",function(a){return Ge(i),xt(r.password,a)||(r.password=a),We(a)}),R()(),N(14,"button",9),V(15,"Registrar"),R(),Ne(16,yw,2,0,"div",10)(17,vw,2,1,"div",11),R()()()}if(t&2){let i=Yo(5);J(9),Dt("ngModel",r.email),J(4),Dt("ngModel",r.password),J(),ie("disabled",r.loading||!i.valid),J(2),ie("ngIf",r.loading),J(),ie("ngIf",r.errorMessage)}},dependencies:[Un,Ln,xn,Nn,On,Fn,Mn,Vn,Be],styles:[`.registro-section[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#a0b316;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='192' height='192' viewBox='0 0 192 192'%3E%3Cpath fill='%23ffffff' fill-opacity='0.91' d='M192 15v2a11 11 0 0 0-11 11c0 1.94 1.16 4.75 2.53 6.11l2.36 2.36a6.93 6.93 0 0 1 1.22 7.56l-.43.84a8.08 8.08 0 0 1-6.66 4.13H145v35.02a6.1 6.1 0 0 0 3.03 4.87l.84.43c1.58.79 4 .4 5.24-.85l2.36-2.36a12.04 12.04 0 0 1 7.51-3.11 13 13 0 1 1 .02 26 12 12 0 0 1-7.53-3.11l-2.36-2.36a4.93 4.93 0 0 0-5.24-.85l-.84.43a6.1 6.1 0 0 0-3.03 4.87V143h35.02a8.08 8.08 0 0 1 6.66 4.13l.43.84a6.91 6.91 0 0 1-1.22 7.56l-2.36 2.36A10.06 10.06 0 0 0 181 164a11 11 0 0 0 11 11v2a13 13 0 0 1-13-13 12 12 0 0 1 3.11-7.53l2.36-2.36a4.93 4.93 0 0 0 .85-5.24l-.43-.84a6.1 6.1 0 0 0-4.87-3.03H145v35.02a8.08 8.08 0 0 1-4.13 6.66l-.84.43a6.91 6.91 0 0 1-7.56-1.22l-2.36-2.36A10.06 10.06 0 0 0 124 181a11 11 0 0 0-11 11h-2a13 13 0 0 1 13-13c2.47 0 5.79 1.37 7.53 3.11l2.36 2.36a4.94 4.94 0 0 0 5.24.85l.84-.43a6.1 6.1 0 0 0 3.03-4.87V145h-35.02a8.08 8.08 0 0 1-6.66-4.13l-.43-.84a6.91 6.91 0 0 1 1.22-7.56l2.36-2.36A10.06 10.06 0 0 0 107 124a11 11 0 0 0-22 0c0 1.94 1.16 4.75 2.53 6.11l2.36 2.36a6.93 6.93 0 0 1 1.22 7.56l-.43.84a8.08 8.08 0 0 1-6.66 4.13H49v35.02a6.1 6.1 0 0 0 3.03 4.87l.84.43c1.58.79 4 .4 5.24-.85l2.36-2.36a12.04 12.04 0 0 1 7.51-3.11A13 13 0 0 1 81 192h-2a11 11 0 0 0-11-11c-1.94 0-4.75 1.16-6.11 2.53l-2.36 2.36a6.93 6.93 0 0 1-7.56 1.22l-.84-.43a8.08 8.08 0 0 1-4.13-6.66V145H11.98a6.1 6.1 0 0 0-4.87 3.03l-.43.84c-.79 1.58-.4 4 .85 5.24l2.36 2.36a12.04 12.04 0 0 1 3.11 7.51A13 13 0 0 1 0 177v-2a11 11 0 0 0 11-11c0-1.94-1.16-4.75-2.53-6.11l-2.36-2.36a6.93 6.93 0 0 1-1.22-7.56l.43-.84a8.08 8.08 0 0 1 6.66-4.13H47v-35.02a6.1 6.1 0 0 0-3.03-4.87l-.84-.43c-1.59-.8-4-.4-5.24.85l-2.36 2.36A12 12 0 0 1 28 109a13 13 0 1 1 0-26c2.47 0 5.79 1.37 7.53 3.11l2.36 2.36a4.94 4.94 0 0 0 5.24.85l.84-.43A6.1 6.1 0 0 0 47 84.02V49H11.98a8.08 8.08 0 0 1-6.66-4.13l-.43-.84a6.91 6.91 0 0 1 1.22-7.56l2.36-2.36A10.06 10.06 0 0 0 11 28 11 11 0 0 0 0 17v-2a13 13 0 0 1 13 13c0 2.47-1.37 5.79-3.11 7.53l-2.36 2.36a4.94 4.94 0 0 0-.85 5.24l.43.84A6.1 6.1 0 0 0 11.98 47H47V11.98a8.08 8.08 0 0 1 4.13-6.66l.84-.43a6.91 6.91 0 0 1 7.56 1.22l2.36 2.36A10.06 10.06 0 0 0 68 11 11 11 0 0 0 79 0h2a13 13 0 0 1-13 13 12 12 0 0 1-7.53-3.11l-2.36-2.36a4.93 4.93 0 0 0-5.24-.85l-.84.43A6.1 6.1 0 0 0 49 11.98V47h35.02a8.08 8.08 0 0 1 6.66 4.13l.43.84a6.91 6.91 0 0 1-1.22 7.56l-2.36 2.36A10.06 10.06 0 0 0 85 68a11 11 0 0 0 22 0c0-1.94-1.16-4.75-2.53-6.11l-2.36-2.36a6.93 6.93 0 0 1-1.22-7.56l.43-.84a8.08 8.08 0 0 1 6.66-4.13H143V11.98a6.1 6.1 0 0 0-3.03-4.87l-.84-.43c-1.59-.8-4-.4-5.24.85l-2.36 2.36A12 12 0 0 1 124 13a13 13 0 0 1-13-13h2a11 11 0 0 0 11 11c1.94 0 4.75-1.16 6.11-2.53l2.36-2.36a6.93 6.93 0 0 1 7.56-1.22l.84.43a8.08 8.08 0 0 1 4.13 6.66V47h35.02a6.1 6.1 0 0 0 4.87-3.03l.43-.84c.8-1.59.4-4-.85-5.24l-2.36-2.36A12 12 0 0 1 179 28a13 13 0 0 1 13-13zM84.02 143a6.1 6.1 0 0 0 4.87-3.03l.43-.84c.8-1.59.4-4-.85-5.24l-2.36-2.36A12 12 0 0 1 83 124a13 13 0 1 1 26 0c0 2.47-1.37 5.79-3.11 7.53l-2.36 2.36a4.94 4.94 0 0 0-.85 5.24l.43.84a6.1 6.1 0 0 0 4.87 3.03H143v-35.02a8.08 8.08 0 0 1 4.13-6.66l.84-.43a6.91 6.91 0 0 1 7.56 1.22l2.36 2.36A10.06 10.06 0 0 0 164 107a11 11 0 0 0 0-22c-1.94 0-4.75 1.16-6.11 2.53l-2.36 2.36a6.93 6.93 0 0 1-7.56 1.22l-.84-.43a8.08 8.08 0 0 1-4.13-6.66V49h-35.02a6.1 6.1 0 0 0-4.87 3.03l-.43.84c-.79 1.58-.4 4 .85 5.24l2.36 2.36a12.04 12.04 0 0 1 3.11 7.51A13 13 0 1 1 83 68a12 12 0 0 1 3.11-7.53l2.36-2.36a4.93 4.93 0 0 0 .85-5.24l-.43-.84A6.1 6.1 0 0 0 84.02 49H49v35.02a8.08 8.08 0 0 1-4.13 6.66l-.84.43a6.91 6.91 0 0 1-7.56-1.22l-2.36-2.36A10.06 10.06 0 0 0 28 85a11 11 0 0 0 0 22c1.94 0 4.75-1.16 6.11-2.53l2.36-2.36a6.93 6.93 0 0 1 7.56-1.22l.84.43a8.08 8.08 0 0 1 4.13 6.66V143h35.02z'%3E%3C/path%3E%3C/svg%3E");background-size:200px;background-repeat:repeat;background-position:center}.registro-container[_ngcontent-%COMP%]{background:#fff;padding:5rem;border-radius:12px;box-shadow:0 8px 20px #0000001a;max-width:350px;width:100%;margin-top:60px}h1[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-size:2.2rem;color:#343a40;text-align:center}.registro-form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-size:1rem;color:#495057}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:92%;padding:.8rem;border:1px solid #ced4da;border-radius:6px;font-size:1rem;transition:border-color .3s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 3px #007bff40}.form-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem 7rem}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:.8rem 1.5rem;border-radius:6px;cursor:pointer;font-size:1rem;transition:background-color .3s,transform .2s;display:block;margin:0}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.9rem;margin-top:.5rem}@media (max-width: 768px){.registro-container[_ngcontent-%COMP%]{padding:3rem;margin-top:40px}h1[_ngcontent-%COMP%]{font-size:1.8rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:92%;padding:.8rem .7rem}.form-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.8rem 9rem}}.spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:10px}.loader[_ngcontent-%COMP%]{border:8px solid #f3f3f3;border-top:8px solid #3498db;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}`]})};var Sm=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",title:"Home",component:Gi},{path:"login",title:"Login",component:po},{path:"quien-soy",title:"Quien soy",component:mo},{path:"registro",title:"Registro",component:go},{path:"juegos",loadChildren:()=>import("./chunk-Z6YCVXGA.js").then(n=>n.JuegosModule)},{path:"**",redirectTo:"home"}];var Cm={projectId:"muestrahosting-77e1e",appId:"1:490264029325:web:da9d3d51f03b0cf3df5ac4",storageBucket:"muestrahosting-77e1e.appspot.com",apiKey:"AIzaSyAZ3RTfIv8FjXLeCvu98J32Iw_wD3OoejY",authDomain:"muestrahosting-77e1e.firebaseapp.com",messagingSenderId:"490264029325"};var Pm={providers:[Bh({eventCoalescing:!0}),Kh(Sm),wd(()=>Ed(Cm)),vf(()=>wf()),wm(()=>Em())]};var Iw=n=>({active:n});function ww(n,e){n&1&&(N(0,"li")(1,"a",11),V(2,"Login"),R()())}function Ew(n,e){n&1&&(N(0,"li")(1,"a",12),V(2,"Registrarse"),R()())}function Tw(n,e){if(n&1){let t=Xt();N(0,"li")(1,"button",13),ue("click",function(){Ge(t);let i=Oe();return We(i.logOut())}),V(2,"Logout"),R()()}}var _o=class n{constructor(e,t){this.userService=e;this.router=t;this.userService.user$.subscribe(r=>{this.userInLocalStorage=r})}userInLocalStorage=!1;isNavbarOpen;toggleNavbar(){this.isNavbarOpen=!this.isNavbarOpen}logOut(){this.userService.logout(),this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||n)(he(je),he(Xe))};static \u0275cmp=be({type:n,selectors:[["app-navbar"]],standalone:!0,features:[Ae],decls:17,vars:6,consts:[[1,"navbar"],[1,"navbar-container"],[1,"navbar-brand"],["routerLink","home",1,"brand-link"],[1,"fa-solid","fa-gamepad"],[1,"hamburger",3,"click"],[1,"fa-solid","fa-bars"],[1,"navbar-list",3,"ngClass"],["routerLink","/home"],["routerLink","/quien-soy"],[4,"ngIf"],["routerLink","/login"],["routerLink","/registro"],[1,"logout-button",3,"click"]],template:function(t,r){t&1&&(N(0,"nav",0)(1,"div",1)(2,"div",2)(3,"a",3),ce(4,"i",4),R()(),N(5,"button",5),ue("click",function(){return r.toggleNavbar()}),ce(6,"i",6),R(),N(7,"ul",7)(8,"li")(9,"a",8),V(10,"Inicio"),R()(),N(11,"li")(12,"a",9),V(13,"Sobre m\xED"),R()(),Ne(14,ww,3,0,"li",10)(15,Ew,3,0,"li",10)(16,Tw,3,0,"li",10),R()()()),t&2&&(J(7),ie("ngClass",Vh(4,Iw,r.isNavbarOpen)),J(7),ie("ngIf",!r.userInLocalStorage),J(),ie("ngIf",!r.userInLocalStorage),J(),ie("ngIf",r.userInLocalStorage))},dependencies:[$h,$i,Be,Dn],styles:['.navbar[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2a2a2a,#4b4b4b);padding:1rem 2rem;box-shadow:0 4px 10px #0000004d;position:sticky;top:0;z-index:1000;transition:background .3s}.navbar-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;max-width:1200px;margin:0 auto}.navbar-brand[_ngcontent-%COMP%]{display:flex;align-items:center}.brand-link[_ngcontent-%COMP%]{color:#ffc107;font-size:3.5rem;font-weight:700;text-decoration:none;display:flex;align-items:center;transition:color .3s,transform .3s}.brand-link[_ngcontent-%COMP%]:hover{color:#ffca2c;transform:scale(1.1)}.brand-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:8px}.navbar-list[_ngcontent-%COMP%]{list-style-type:none;display:flex;gap:2rem}.navbar-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar-list[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-size:1.2rem;position:relative;transition:color .3s}.navbar-list[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";display:block;height:2px;background:#ffc107;width:0;transition:width .3s;position:absolute;bottom:-5px;left:50%;transform:translate(-50%)}.navbar-list[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#ffc107}.navbar-list[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{width:100%}.logout-button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;padding:.7rem 1.5rem;border-radius:5px;cursor:pointer;font-size:1rem;transition:background-color .3s,transform .2s}.logout-button[_ngcontent-%COMP%]:hover{background-color:#c82333;transform:scale(1.05)}.hamburger[_ngcontent-%COMP%]{display:none;font-size:2rem;background:none;border:none;color:#fff;cursor:pointer}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{padding:1rem}.navbar-list[_ngcontent-%COMP%]{display:none;flex-direction:column;width:100%;position:absolute;top:60px;left:0;background:#343a40;z-index:1000;gap:.3rem}.navbar-list.active[_ngcontent-%COMP%]{display:flex}.navbar-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100%;text-align:center;padding:1rem 0}.logout-button[_ngcontent-%COMP%]{width:78%;padding:.7rem;border-radius:5px}.hamburger[_ngcontent-%COMP%]{display:block}}']})};var yo=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=be({type:n,selectors:[["app-footer"]],standalone:!0,features:[Ae],decls:6,vars:0,consts:[[1,"footer"],[1,"footer-container"],["href","https://github.com/CristianDelgado31/sala_juegos.git","target","_blank",1,"footer-link"],[1,"fab","fa-github"]],template:function(t,r){t&1&&(N(0,"footer",0)(1,"div",1)(2,"p")(3,"a",2),ce(4,"i",3),V(5," Repositorio de GitHub "),R()()()())},styles:[".footer[_ngcontent-%COMP%]{background-color:#343a40;color:#fff;padding:1.5rem 1rem;text-align:center;position:relative}.footer-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.footer-link[_ngcontent-%COMP%]{color:#fff;text-decoration:none;transition:color .3s;font-size:1.1rem;display:inline-flex;align-items:center}.footer-link[_ngcontent-%COMP%]:hover{color:#ffc107}.footer-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem;font-size:1.5rem}@media (max-width: 768px){.footer[_ngcontent-%COMP%]{padding:1rem}.footer-link[_ngcontent-%COMP%]{font-size:1rem}.footer-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}}"]})};var vo=class{fecha;mensaje;usuario;email;constructor(e,t,r,i){this.fecha=this.convertTimestampToDate(e),this.mensaje=t,this.usuario=r,this.email=i}convertTimestampToDate(e){return e&&e.seconds?new Date(e.seconds*1e3):new Date}};var bw=["chatMessages"],Aw=(n,e)=>({"my-message":n,"other-message":e});function Sw(n,e){if(n&1&&(N(0,"div",12)(1,"span",13),V(2),R(),N(3,"span",14),V(4),R(),N(5,"span",15),V(6),Lh(7,"date"),R()()),n&2){let t=e.$implicit,r=Oe(3);ie("ngClass",Mh(7,Aw,t.usuario===r.currentUser,t.usuario!==r.currentUser)),J(2),Zt(t.usuario===r.currentUser?"yo":t.usuario),J(2),Zt(t.mensaje),J(2),zi(" ",t.fecha?Fh(7,4,t.fecha,"dd/MM/yy HH:mm"):"Sin hora"," ")}}function Cw(n,e){if(n&1){let t=Xt();N(0,"div",4)(1,"div",5)(2,"h2"),V(3,"Chat"),R(),N(4,"i",6),ue("click",function(){Ge(t);let i=Oe(2);return We(i.toggleChat())}),R()(),N(5,"div",7,0),Ne(7,Sw,8,10,"div",8),R(),N(8,"form",9),ue("ngSubmit",function(){Ge(t);let i=Oe(2);return We(i.sendMessage())}),N(9,"input",10),Nt("ngModelChange",function(i){Ge(t);let o=Oe(2);return xt(o.newMessage,i)||(o.newMessage=i),We(i)}),R(),N(10,"button",11),V(11,"Enviar"),R()()()}if(n&2){let t=Oe(2);J(7),ie("ngForOf",t.MessagesCollection),J(2),Dt("ngModel",t.newMessage)}}function Pw(n,e){if(n&1){let t=Xt();N(0,"div",1),ue("click",function(){Ge(t);let i=Oe();return We(i.toggleChat())}),ce(1,"i",2),R(),Ne(2,Cw,12,2,"div",3)}if(n&2){let t=Oe();J(2),ie("ngIf",t.isChatVisible)}}var Io=class n{constructor(e,t,r,i){this.userService=e;this.firestore=t;this.auth=r;this.router=i}newMessage="";currentUser="Usuario";currentEmail="";userInLocalStorage=!1;isChatVisible=!1;userSubscription;messageSubscription;MessagesCollection=[];countMessages=0;chatMessages;ngOnInit(){this.userSubscription=this.userService.user$.subscribe(e=>{if(this.userInLocalStorage=e,this.userInLocalStorage){let r=JSON.parse(localStorage.getItem("user")).email;this.currentUser=r.split("@")[0],this.currentEmail=r}})}ngOnDestroy(){this.userSubscription&&this.userSubscription.unsubscribe(),this.messageSubscription&&this.messageSubscription.unsubscribe()}toggleChat(){this.isChatVisible=!this.isChatVisible,this.isChatVisible&&this.getMessages()}sendMessage(){this.newMessage.trim()&&(this.logChat(this.newMessage),this.newMessage="")}logChat(e){let t=_r(this.firestore,"chat"),r={fecha:ge.fromDate(new Date),usuario:this.currentUser,email:this.currentEmail,mensaje:e};ho(t,r)}getMessages(){let e=_r(this.firestore,"chat"),t=fo(e,Tm("fecha","asc")),r=lo(t);this.messageSubscription=r.subscribe(i=>{this.MessagesCollection=i.map(o=>{let a=o.fecha;return new vo(a,o.mensaje,o.usuario,o.email)}),this.countMessages=this.MessagesCollection.length,this.scrollToBottom()})}scrollToBottom(){setTimeout(()=>{this.chatMessages.nativeElement.scrollTop=this.chatMessages.nativeElement.scrollHeight},0)}static \u0275fac=function(t){return new(t||n)(he(je),he(bt),he(He),he(Xe))};static \u0275cmp=be({type:n,selectors:[["app-chat"]],viewQuery:function(t,r){if(t&1&&xh(bw,5),t&2){let i;Nh(i=Oh())&&(r.chatMessages=i.first)}},standalone:!0,features:[Ae],decls:1,vars:1,consts:[["chatMessages",""],[1,"chat-icon",3,"click"],[1,"fa-brands","fa-rocketchat"],["class","chat-container",4,"ngIf"],[1,"chat-container"],[1,"chat-header"],[1,"fa-solid","fa-x","close-chat",3,"click"],[1,"chat-messages"],["class","message",3,"ngClass",4,"ngFor","ngForOf"],[1,"chat-input",3,"ngSubmit"],["name","message","placeholder","Escribe un mensaje...","required","","autocomplete","off",3,"ngModelChange","ngModel"],["type","submit"],[1,"message",3,"ngClass"],[1,"sender"],[1,"text"],[1,"timestamp"]],template:function(t,r){t&1&&Ne(0,Pw,3,1),t&2&&Dh(r.userInLocalStorage?0:-1)},dependencies:[Un,Ln,xn,Nn,On,Fn,Mn,Vn,jh,$i,Be,zh],styles:[".chat-icon[_ngcontent-%COMP%]{position:fixed;bottom:15px;right:20px;cursor:pointer;z-index:1000;background-color:#25d366;color:#fff;border-radius:50%;width:70px;height:70px;display:flex;justify-content:center;align-items:center;box-shadow:0 4px 20px #0000004d;transition:background-color .3s,transform .3s,box-shadow .3s}.chat-icon[_ngcontent-%COMP%]:hover{background-color:#1ebe5d;transform:scale(1.1);box-shadow:0 6px 25px #0006}.chat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:450px;width:350px;border-radius:12px;position:fixed;bottom:80px;right:20px;background-color:#121212;box-shadow:0 4px 25px #0000004d;overflow:hidden;z-index:999}.chat-header[_ngcontent-%COMP%]{background-color:#25d366;color:#fff;padding:15px;display:flex;justify-content:space-between;align-items:center;border-top-left-radius:12px;border-top-right-radius:12px}.chat-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.3em}.close-chat[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;font-size:1.4em}.chat-messages[_ngcontent-%COMP%]{flex:1;padding:15px;overflow-y:auto;background-color:#1e1e1e}.message[_ngcontent-%COMP%]{margin:10px 0;max-width:80%;border-radius:10px;padding:12px;position:relative;transition:background-color .2s}.my-message[_ngcontent-%COMP%]{background-color:#218838;margin-left:auto}.other-message[_ngcontent-%COMP%]{background-color:#444;color:#fff}.sender[_ngcontent-%COMP%]{font-weight:700;color:#fff}.text[_ngcontent-%COMP%]{display:block;color:#fff}.timestamp[_ngcontent-%COMP%]{font-size:.8em;color:#ffffffa6;position:absolute;bottom:5px;right:10px}.chat-input[_ngcontent-%COMP%]{display:flex;padding:10px;border-top:1px solid #333;background-color:#1e1e1e}.chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:10px;border:none;background-color:#333;color:#fff;border-radius:20px;font-size:1em;box-shadow:0 2px 5px #0000001a}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px;padding:10px 15px;background-color:#25d366;color:#fff;border:none;border-radius:20px;cursor:pointer;transition:background-color .3s,transform .2s}.chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1ebe5d;transform:scale(1.05)}"]})};function Rw(n,e){n&1&&ce(0,"app-chat")}var wo=class n{constructor(e){this.userService=e;this.userService.user$.subscribe(t=>{this.isLoggedIn=t})}title="sala-de-juegos";isLoggedIn=!1;static \u0275fac=function(t){return new(t||n)(he(je))};static \u0275cmp=be({type:n,selectors:[["app-root"]],standalone:!0,features:[Ae],decls:4,vars:1,consts:[[1,"router-outlet"],[4,"ngIf"]],template:function(t,r){t&1&&(ce(0,"app-navbar")(1,"router-outlet",0),Ne(2,Rw,1,0,"app-chat",1),ce(3,"app-footer")),t&2&&(J(2),ie("ngIf",r.isLoggedIn))},dependencies:[Wh,_o,yo,Io,Be],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;margin:0}[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:100vh}router-outlet[_ngcontent-%COMP%]{flex:1}"]})};Gh(wo,Pm).catch(n=>console.error(n));
